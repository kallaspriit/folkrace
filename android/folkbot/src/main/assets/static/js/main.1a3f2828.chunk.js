(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{43:function(t,e,n){t.exports=n(65)},65:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n(18),o=(n(48),n(4)),i=n(3),c=n(7),s=n(6),u=n(8),l=n(2),f=n(67),h=n(70),d=n(66),m=n(68),p=n(13),b=n(5),g=n(16),v=n(69);function O(){var t=Object(l.a)(['\n  // main font\n  @font-face {\n    font-family: "heebo-regular";\n    src: url("fonts/Heebo-Regular.ttf");\n    font-weight: normal;\n    font-style: normal;\n  }\n\n  // default to using border box sizing\n  html {\n    box-sizing: border-box;\n  }\n  *,\n  *:before,\n  *:after {\n    box-sizing: inherit;\n  }\n\n  // set body styles\n  body,\n  html {\n    height: 100;\n    padding: 0;\n    margin: 0;\n    font-family: "heebo-regular";\n    color: ',";\n    background-color: ",";\n  }\n"]);return O=function(){return t},t}function E(){var t=Object(l.a)(["\n      0% {\n        background: ",";\n      }\n      50% {\n        background: ",";\n      }\n      100% {\n        background: ",";\n      }\n    "]);return E=function(){return t},t}function y(){var t=Object(l.a)(["\n      from {\n        opacity: 0;\n      }\n      to {\n        opacity: 1;\n      }\n    "]);return y=function(){return t},t}var S={text:{primary:"#f0f0f0",secondary:"#969696"},bg:{primary:"#cc3333",secondary:"#282828",tertiary:Object(g.b)(.05,"#282828"),quaternary:"#087099",good:"#009900",warn:"#999900",bad:"#990000"},size:{darkerLighterPercentage:.25,gridGap:"2px",menuHeight:"64px"},animation:{fadeIn:Object(p.e)(y()),pulse:function(t){return Object(p.e)(E(),t,Object(g.b)(.25,t),t)}}},j=p.d,w=Object(p.b)(O(),S.text.primary,S.bg.secondary);function k(){var t=Object(l.a)(["\n  display: block;\n  width: ","px;\n  height: ","px;\n  mask-image: url(",");\n  mask-size: ","px ","px;\n  mask-repeat: no-repeat;\n  mask-position: center center;\n  background-color: ",";\n"]);return k=function(){return t},t}var C=j.i(k(),function(t){return t.width},function(t){return t.height},function(t){return t.url},function(t){return t.height},function(t){return t.width},function(t){return t.theme.text.primary}),N=function(t){return r.createElement(C,Object.assign({},t,{url:"icons/status.svg",width:37,height:32}))},T=function(t){return r.createElement(C,Object.assign({},t,{url:"icons/map.svg",width:32,height:32}))},x=function(t){return r.createElement(C,Object.assign({},t,{url:"icons/bot.svg",width:27,height:32}))},I=function(t){return r.createElement(C,Object.assign({},t,{url:"icons/remote.svg",width:44,height:32}))},D=function(t){return r.createElement(C,Object.assign({},t,{url:"icons/settings.svg",width:32,height:32}))},R=function(t){return r.createElement(C,Object.assign({},t,{url:"icons/bluetooth.svg",width:32,height:32}))},A=function(t){return r.createElement(C,Object.assign({},t,{url:"icons/serial.svg",width:32,height:32}))},L=function(t){return r.createElement(C,Object.assign({},t,{url:"icons/web-socket.svg",width:32,height:32}))},U=function(t){return r.createElement(C,Object.assign({},t,{url:"icons/battery.svg",width:32,height:32}))};function B(){var t=Object(l.a)(["\n  text-align: center;\n  font-variant: ",";\n  line-height: 1.2em;\n"]);return B=function(){return t},t}var M=j.div(B(),function(t){return t.primary?"all-small-caps":"normal"});function W(){var t=Object(l.a)(["\n  padding-top: 4px;\n"]);return W=function(){return t},t}function F(){var t=Object(l.a)(["\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 100%;\n  text-decoration: none;\n  color: ","\n  background-color: rgba(0, 0, 0, 0);\n  transition: background-color 300ms;\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n\n  &.active-main-menu-item {\n    background-color: ",";\n    color: ","\n  }\n"]);return F=function(){return t},t}function G(){var t=Object(l.a)(["\n  height: 100%;\n  text-align: center;\n  font-variant: small-caps;\n  text-transform: uppercase;\n  font-size: 0.8em;\n  flex: 1;\n"]);return G=function(){return t},t}function H(){var t=Object(l.a)(["\n  display: flex;\n  flex-direction: row;\n  height: ",";\n  flex: 1;\n  max-width: 600px;\n"]);return H=function(){return t},t}function z(){var t=Object(l.a)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  background-color: #000;\n"]);return z=function(){return t},t}var P,V,K=j.div(z()),X=j.ul(H(),function(t){return t.theme.size.menuHeight}),q=j.li(G()),J=j(v.a)(F(),function(t){return Object(g.a)(t.theme.size.darkerLighterPercentage,t.theme.text.primary)},function(t){return t.theme.bg.secondary},function(t){return t.theme.text.primary}),_=j(M)(W()),Y=function(){return r.createElement(K,null,r.createElement(X,null,r.createElement(q,null,r.createElement(J,{to:"/status",activeClassName:"active-main-menu-item"},r.createElement(N,null),r.createElement(_,null,"Status"))),r.createElement(q,null,r.createElement(J,{to:"/map",activeClassName:"active-main-menu-item"},r.createElement(T,null),r.createElement(_,null,"Map"))),r.createElement(q,null,r.createElement(J,{to:"/bot",activeClassName:"active-main-menu-item"},r.createElement(x,null),r.createElement(_,null,"Bot"))),r.createElement(q,null,r.createElement(J,{to:"/remote",activeClassName:"active-main-menu-item"},r.createElement(I,null),r.createElement(_,null,"Remote"))),r.createElement(q,null,r.createElement(J,{to:"/settings",activeClassName:"active-main-menu-item"},r.createElement(D,null),r.createElement(_,null,"Settings")))))},$=n(34),Q=n(40),Z=n(9);!function(t){t.START="START",t.LEFT="LEFT",t.RIGHT="RIGHT"}(P||(P={})),function(t){t.UNKNOWN="UNKNOWN",t.PRESSED="PRESSED",t.RELEASED="RELEASED"}(V||(V={}));var tt,et=function(t){function e(){var t,n,r;Object(o.a)(this,e);for(var a=arguments.length,i=new Array(a),u=0;u<a;u++)i[u]=arguments[u];return(r=Object(c.a)(this,(t=Object(s.a)(e)).call.apply(t,[this].concat(i)))).state=(n={},Object(Z.a)(n,P.START,V.UNKNOWN),Object(Z.a)(n,P.LEFT,V.UNKNOWN),Object(Z.a)(n,P.RIGHT,V.UNKNOWN),n),r}return Object(u.a)(e,t),Object(i.a)(e,[{key:"setButtonState",value:function(t,e){return this.setState(Object(Z.a)({},t,e))}}]),e}(b.a),nt=n(14),rt=function(t){function e(){var t,n;Object(o.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(c.a)(this,(t=Object(s.a)(e)).call.apply(t,[this].concat(a)))).state={isStarted:!1,isValid:!1,targetRpm:0,currentRpm:0,motorPwm:0},n}return Object(u.a)(e,t),Object(i.a)(e,[{key:"update",value:function(t){return this.setState(Object(nt.a)({},t))}}]),e}(b.a),at=n(17);!function(t){t.INFO="INFO",t.ERROR="ERROR",t.RX="RX",t.TX="TX"}(tt||(tt={}));var ot,it=function(t){function e(){var t,n;Object(o.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(c.a)(this,(t=Object(s.a)(e)).call.apply(t,[this].concat(a)))).state={entries:[]},n.lastId=0,n}return Object(u.a)(e,t),Object(i.a)(e,[{key:"addEntry",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.setState(function(r){var a=e.state.entries.length>0?e.state.entries[e.state.entries.length-1]:null,o=e.resolveMessageType(t);if(null!==a&&n&&t===a.message)return{entries:Object(at.a)(r.entries.slice(0,e.state.entries.length-1)).concat([{id:(e.lastId++).toString(),time:new Date,message:t,type:o,count:a.count+1}])};for(var i=Object(at.a)(r.entries).concat([{id:(e.lastId++).toString(),time:new Date,message:t,type:o,count:1}]);i.length>200;)i.shift();return{entries:i}}).catch(function(t){return console.error(t)})}},{key:"clear",value:function(){this.setState({entries:[]}).catch(function(t){return console.error(t)})}},{key:"resolveMessageType",value:function(t){switch(t.substr(0,1)){case"<":return tt.RX;case">":return tt.TX;case"@":return tt.ERROR;case"#":default:return tt.INFO}}}]),e}(b.a),ct=function(t){function e(){var t,n;Object(o.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(c.a)(this,(t=Object(s.a)(e)).call.apply(t,[this].concat(a)))).state={measurements:[]},n}return Object(u.a)(e,t),Object(i.a)(e,[{key:"add",value:function(t){return this.setState({measurements:Object(at.a)(this.state.measurements).concat([t])})}}]),e}(b.a),st=function(t){function e(){var t,n;Object(o.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(c.a)(this,(t=Object(s.a)(e)).call.apply(t,[this].concat(a)))).state={left:0,right:0},n}return Object(u.a)(e,t),Object(i.a)(e,[{key:"update",value:function(t,e){return this.setState({left:t,right:e})}}]),e}(b.a),ut=function(t){function e(){var t,n;Object(o.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(c.a)(this,(t=Object(s.a)(e)).call.apply(t,[this].concat(a)))).state={targetSpeed:{left:0,right:0},current:{left:0,right:0}},n}return Object(u.a)(e,t),Object(i.a)(e,[{key:"setTargetSpeed",value:function(t,e){return this.setState({targetSpeed:{left:t,right:e}})}},{key:"setCurrent",value:function(t,e){return this.setState({current:{left:t,right:e}})}}]),e}(b.a),lt=n(35),ft=n.n(lt),ht={webSocket:{host:void 0!==localStorage.webSocketHost?localStorage.webSocketHost:"127.0.0.1",port:void 0!==localStorage.webSocketPort?parseInt(localStorage.webSocketPort,10):8e3,useSSL:!1,reconnectInterval:3e3},rules:{battery:{low:15,critical:13.5}},vehicle:{trackWidth:.15,maxSpeed:1,wheelDiameter:.039,encoderCountsPerRotation:20,gearboxRatio:25,speedUpdateInterval:50}},dt=n(24);!function(t){t.DISCONNECTED="DISCONNECTED",t.CONNECTING="CONNECTING",t.RECONNECTING="RECONNECTING",t.CONNECTED="CONNECTED"}(ot||(ot={}));var mt,pt,bt,gt=function(){function t(e){Object(o.a)(this,t),this.connectionState=ot.DISCONNECTED,this.listeners=[],this.wasConnected=!1,this.options=Object(nt.a)({useSSL:!1,log:dt.dummyLogger,reconnectInterval:1e3},e),this.log=this.options.log,this.url="".concat(this.options.useSSL?"wss":"ws","://").concat(this.options.host,":").concat(this.options.port)}return Object(i.a)(t,[{key:"state",get:function(){return this.connectionState}}]),Object(i.a)(t,[{key:"subscribe",value:function(t){this.listeners.push(t)}},{key:"unsubscribe",value:function(t){this.listeners=this.listeners.filter(function(e){return e!==t})}},{key:"send",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.ws&&this.state===ot.CONNECTED?(this.listeners.forEach(function(n){return n.onSendMessage(e,t)}),this.ws.send("".concat(t).concat(n?"\n":""))):this.log.warn('sending message "'.concat(t,'" requested but web-socket is ').concat(this.connectionState))}},{key:"toast",value:function(t){this.send("!toast:".concat(t))}},{key:"connect",value:function(){var t=this;this.log.info("connecting to web-socket server at ".concat(this.url)),this.setState(this.wasConnected?ot.RECONNECTING:ot.CONNECTING),this.listeners.forEach(function(e){return e.onConnecting(t,t.wasConnected)}),this.ws=new WebSocket(this.url),this.ws.onopen=function(e){t.log.info("established web-socket connection"),t.wasConnected=!0,t.setState(ot.CONNECTED),t.listeners.forEach(function(n){return n.onOpen(t,e)})},this.ws.onclose=function(e){var n="code: ".concat(e.code,", reason: ").concat(e.reason,", was clean: ").concat(e.wasClean?"yes":"no");t.wasConnected?t.log.warn("connection to web-socket was lost (".concat(n,")")):t.log.warn("connecting to web-socket failed (".concat(n,")")),t.setState(ot.DISCONNECTED),setTimeout(function(){t.connect()},t.options.reconnectInterval),t.listeners.forEach(function(n){return n.onClose(t,e,t.wasConnected)})},this.ws.onerror=function(e){t.log.warn("got web-socket error"),t.listeners.forEach(function(n){return n.onError(t,e,t.wasConnected)})},this.ws.onmessage=function(e){t.listeners.forEach(function(n){return n.onMessage(t,e.data)})}}},{key:"setState",value:function(t){var e=this;if(t!==this.connectionState){var n=this.connectionState;this.connectionState=t,this.listeners.forEach(function(r){return r.onStateChanged(e,t,n)})}}}]),t}();!function(t){t.USB="usb",t.BLUETOOTH="bluetooth"}(mt||(mt={})),function(t){t.CONNECTING="CONNECTING",t.CONNECTED="CONNECTED",t.DISCONNECTED="DISCONNECTED",t.NOT_SUPPORTED="NOT_SUPPORTED",t.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",t.DISABLED="DISABLED"}(pt||(pt={})),function(t){t.UNKNOWN="UNKNOWN",t.FULL="FULL",t.LOW="LOW",t.CRITICAL="CRITICAL"}(bt||(bt={}));var vt=function(t){function e(){var t,n;Object(o.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(c.a)(this,(t=Object(s.a)(e)).call.apply(t,[this].concat(a)))).state={serials:{BLUETOOTH:{type:mt.BLUETOOTH,state:pt.DISCONNECTED,deviceName:void 0},USB:{type:mt.USB,state:pt.DISCONNECTED,deviceName:void 0}},webSocketState:ot.DISCONNECTED},n}return Object(u.a)(e,t),Object(i.a)(e,[{key:"setSerialState",value:function(t,e,n){var r=Object.keys(mt).find(function(e){return mt[e]===t});return this.setState(ft()(this.state,{serials:Object(Z.a)({},r,{$merge:{state:e,deviceName:n}})}))}},{key:"setWebSocketState",value:function(t){return this.setState({webSocketState:t})}},{key:"setBatteryVoltage",value:function(t){return this.setState({batteryVoltage:t})}},{key:"setRemoteIp",value:function(t){return this.setState({remoteIp:t})}},{key:"setOffline",value:function(){return this.setState({remoteIp:void 0})}},{key:"setLoopStatistics",value:function(t,e){return this.setState({lastBeaconTime:new Date,loopFrequency:t,loopTimeUs:e})}},{key:"setResetReceived",value:function(){return this.setState({lastResetTime:new Date})}},{key:"getConnectedSerial",value:function(){var t=this;return Object.keys(this.state.serials).map(function(e){return t.state.serials[e]}).find(function(t){return t.state===pt.CONNECTED})}},{key:"batteryState",get:function(){var t=this.state.batteryVoltage;return void 0===t?bt.UNKNOWN:t<=ht.rules.battery.critical?bt.CRITICAL:t<=ht.rules.battery.low?bt.LOW:bt.FULL}}]),e}(b.a);function Ot(t,e){var n=e.status,r=parseInt(t[0],10),a=parseInt(t[1],10),o=a/r*1e3,i=r/a*1e3;n.setLoopStatistics(o,i)}function Et(t,e){var n=e.button,r=t[0],a=0===parseInt(t[1],10)?V.PRESSED:V.RELEASED;n.setButtonState(r.toUpperCase(),a)}function yt(t,e){var n=e.robot,r=parseInt(t[0],10),a=parseInt(t[1],10);n.setCurrent(r,a)}function St(t,e){var n=e.odometry,r=parseInt(t[0],10),a=parseInt(t[1],10);n.update(r,a)}function jt(t,e){var n=e.status,r=parseFloat(t[0]);n.setBatteryVoltage(r)}function wt(t,e){var n=e.status,r=t[0];"null"===r?n.setOffline():n.setRemoteIp(r)}function kt(t,e){var n=e.lidar,r=1===parseInt(t[0],10),a=1===parseInt(t[1],10),o=parseFloat(t[2]),i=parseFloat(t[3]),c=parseFloat(t[4]);n.update({isStarted:r,isValid:a,targetRpm:o,currentRpm:i,motorPwm:c})}function Ct(t,e){e.measurements.add({angle:parseInt(t[0],10),distance:parseInt(t[1],10),quality:parseInt(t[2],10),date:new Date})}var Nt=function(){function t(e){Object(o.a)(this,t),this.webSocketClient=e}return Object(i.a)(t,[{key:"requestVoltage",value:function(){this.send("voltage")}},{key:"requestState",value:function(){this.send("state")}},{key:"setSpeed",value:function(t,e){this.send("s",t,e)}},{key:"ping",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.pingSentTime=Date.now(),t?this.webSocketClient.send("!ping",!1):this.send("ping")}},{key:"send",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var a="".concat(t).concat(n.length>0?":":"").concat(n.join(":"));this.webSocketClient.send(a)}}]),t}(),Tt=new gt(Object(nt.a)({},ht.webSocket)),xt=new Nt(Tt);function It(t,e){var n=e.log;if(xt.pingSentTime){var r=Date.now()-xt.pingSentTime;xt.pingSentTime=void 0,n.addEntry("# ping: ".concat(r," ms"))}}function Dt(t,e){e.status.setResetReceived()}var Rt=n(29),At=n.n(Rt),Lt=n(36);function Ut(t,e){return Bt.apply(this,arguments)}function Bt(){return(Bt=Object(Lt.a)(At.a.mark(function t(e,n){var r,a,o,i,c;return At.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.status,a=e[0],o=e[1],i="string"===typeof e[2]?e[2]:void 0,t.next=6,r.setSerialState(a,o,i);case 6:void 0!==(c=r.getConnectedSerial())&&a===c.type?xt.requestState():r.setBatteryVoltage(void 0);case 8:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}function Mt(t,e){var n=e.robot,r=parseInt(t[0],10),a=parseInt(t[1],10);n.setTargetSpeed(r,a)}function Wt(t,e){var n=parseInt(t[0],10),r=parseInt(t[1],10),a=t[2];console.log("usb",{vendorId:n,productId:r,productName:a})}var Ft=[],Gt=function(){function t(){Object(o.a)(this,t)}return Object(i.a)(t,[{key:"receive",value:function(t){console.log("MockJavascriptInterface","receive",t)}}]),t}(),Ht=new(function(){function t(){var e=this;if(Object(o.a)(this,t),void 0===window.robot)return console.log("no javascript interface is available"),this.robot=new Gt,void(this.isAvailable=!1);this.robot=window.robot,this.isAvailable=!0,window.app={receive:function(t){return e.onMessageReceived(t)}}}return Object(i.a)(t,[{key:"send",value:function(t){this.robot.receive(t)}},{key:"onMessageReceived",value:function(t){!function(t){Ft.forEach(function(e){return e(t)})}('# received "'.concat(t,'"'))}}]),t}()),zt=function(t){function e(){var t,n;Object(o.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(c.a)(this,(t=Object(s.a)(e)).call.apply(t,[this].concat(a)))).isInitialized=!1,n.webSocketCommandHandlers={serial:Ut,ip:wt,usb:Wt,voltage:jt,button:Et,reset:Dt,current:yt,lidar:kt,pong:It,e:St,b:Ot,m:Ct,s:Mt},n}return Object(u.a)(e,t),Object(i.a)(e,[{key:"render",value:function(){var t=this;return r.createElement(b.c,{to:[it,vt,st,rt,et,ut,ct]},function(e,n,r,a,o,i,c){return t.isInitialized?null:(s=function(t){return e.addEntry(t)},Ft.push(s),n.setWebSocketState(Tt.state),Tt.subscribe({onConnecting:function(t,n){e.addEntry("# connecting to ".concat(t.url))},onOpen:function(t,n){e.addEntry("# web-socket connection established")},onClose:function(t,n,r){r?e.addEntry("# web-socket connection was lost"):e.addEntry("# establishing web-socket connection failed")},onError:function(t,n,r){e.addEntry("# get web-socket error")},onMessage:function(s,u){t.handleWebSocketMessage(u,{log:e,status:n,odometry:r,lidar:a,button:o,robot:i,measurements:c})},onStateChanged:function(t,e,r){n.setWebSocketState(e),e===ot.DISCONNECTED&&(n.setSerialState(mt.BLUETOOTH,pt.DISCONNECTED),n.setSerialState(mt.USB,pt.DISCONNECTED),n.setBatteryVoltage(void 0))},onSendMessage:function(t,n){var r=n.split(":");1!==Object(Q.a)(r,1)[0].length&&e.addEntry("> ".concat(n))}}),Tt.connect(),Ht.send("Hello from app!"),t.isInitialized=!0,null);var s})}},{key:"handleWebSocketMessage",value:function(t,e){if(0!==t.length){var n=t.split(":"),r=Object($.a)(n),a=r[0],o=r.slice(1);a.length>1&&e.log.addEntry("< ".concat(t)),this.handleWebSocketCommand(a,o,e)}}},{key:"handleWebSocketCommand",value:function(t,e,n){var r=this.webSocketCommandHandlers[t];void 0!==r?r(e,n):console.warn('missing web-socket command handler for "'.concat(t,'" (').concat(e.join(", "),")"))}}]),e}(r.Component);function Pt(){var t=Object(l.a)(["\n  position: relative;\n  flex: 1;\n  border-radius: 8px 8px 0 0;\n  padding: ",";\n"]);return Pt=function(){return t},t}var Vt,Kt,Xt=j.div(Pt(),function(t){return t.text?"16px":t.grid?t.theme.size.gridGap:"0"}),qt=function(){return r.createElement(Xt,{text:!0},"Bot")},Jt=function(){return r.createElement(Xt,{text:!0},"Map")};function _t(){var t=Object(l.a)(["\n          animation: ","\n            3s ease;\n          animation-iteration-count: infinite;\n          animation-delay: 1s;\n        "]);return _t=function(){return t},t}function Yt(){var t=Object(l.a)(["\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          justify-content: center;\n          padding: 16px;\n          overflow: hidden;\n          background-color: ",";\n        "]);return Yt=function(){return t},t}function $t(){var t=Object(l.a)(["\n          line-height: 1.25em;\n          text-align: center;\n          margin-top: 8px;\n        "]);return $t=function(){return t},t}function Qt(){var t=Object(l.a)(["\n  position: relative;\n  background-color: ",";\n  font-variant: ",";\n\n  ","\n\n  ","\n\n  ","\n"]);return Qt=function(){return t},t}function Zt(){var t=Object(l.a)(["\n  display: grid;\n  grid-gap: ",";\n  height: calc(\n    100vh -\n      (\n        "," +\n          "," * 2\n      )\n  );\n"]);return Zt=function(){return t},t}!function(t){t.GOOD="GOOD",t.WARN="WARN",t.BAD="BAD"}(Kt||(Kt={}));var te=j.div(Zt(),function(t){return t.theme.size.gridGap},function(t){return t.theme.size.menuHeight},function(t){return t.theme.size.gridGap}),ee=(Vt={},Object(Z.a)(Vt,Kt.GOOD,S.bg.good),Object(Z.a)(Vt,Kt.WARN,S.bg.warn),Object(Z.a)(Vt,Kt.BAD,S.bg.bad),Vt),ne=j.div(Qt(),function(t){return t.theme.bg.tertiary},function(t){return t.primary?"all-small-caps":"normal"},function(t){return t.text?Object(p.c)($t()):""},function(t){return t.status?Object(p.c)(Yt(),ee[t.status]):""},function(t){return t.status===Kt.BAD?Object(p.c)(_t(),t.theme.animation.pulse(ee[t.status])):""}),re=n(37),ae=function(t){function e(){var t,n;Object(o.a)(this,e);for(var a=arguments.length,i=new Array(a),u=0;u<a;u++)i[u]=arguments[u];return(n=Object(c.a)(this,(t=Object(s.a)(e)).call.apply(t,[this].concat(i)))).ref=r.createRef(),n}return Object(u.a)(e,t),Object(i.a)(e,[{key:"componentDidMount",value:function(){var t=this,e=this.ref.current;if(e){var n=re.create({zone:e,color:"#FFF",size:200,position:{left:"50%",top:"50%"},mode:"static",lockX:!0===this.props.x,lockY:!0===this.props.y}),r=this.props.onEvent;if("function"===typeof r){var a=this.props.bind?this.props.bind:"start move end dir plain";n.on(a,function(e,n){r(t.props.name,e,n)}).on("removed",function(t,e){e.off(a)})}}else console.warn("grid item dom node not found")}},{key:"render",value:function(){return r.createElement("div",{className:"joystick",ref:this.ref})}}]),e}(r.Component),oe=n(38),ie=n.n(oe),ce=function(){function t(e){Object(o.a)(this,t),this.options=e}return Object(i.a)(t,[{key:"calculateMotorSpeeds",value:function(t,e){return this.limit({left:t+e,right:t-e},this.options.maxSpeed)}},{key:"getSpeedEncoderCount",value:function(t){var e=t/(this.options.wheelDiameter*Math.PI)*(this.options.encoderCountsPerRotation*this.options.gearboxRatio);return Math.floor(e)}},{key:"limit",value:function(t,e){var n=Math.max(Math.abs(t.left),Math.abs(t.right)),r=Math.min(e/n,1);return{left:t.left*r,right:t.right*r}}},{key:"getEncoderSpeeds",value:function(t){return{left:this.getSpeedEncoderCount(t.left),right:this.getSpeedEncoderCount(t.right)}}}]),t}(),se=function(){function t(e){var n=this;Object(o.a)(this,t),this.speed=0,this.omega=0,this.options=Object(nt.a)({log:dt.dummyLogger},e),this.robot=this.options.robot,this.kinematics=new ce(this.options.vehicle),this.scheduleUpdateMotorSpeeds=ie()(function(){return n.updateMotorSpeeds()},this.options.vehicle.speedUpdateInterval)}return Object(i.a)(t,[{key:"setSpeed",value:function(t){this.speed=t,this.scheduleUpdateMotorSpeeds()}},{key:"setOmega",value:function(t){this.omega=t,this.scheduleUpdateMotorSpeeds()}},{key:"updateMotorSpeeds",value:function(){var t=this.kinematics.calculateMotorSpeeds(this.speed,this.omega),e=this.kinematics.getEncoderSpeeds(t);this.robot.setSpeed(e.left,e.right)}}]),t}();function ue(){var t=Object(l.a)(["\n  grid-template-columns: 1fr;\n"]);return ue=function(){return t},t}var le=j(te)(ue()),fe=function(t){function e(){var t,n;Object(o.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(n=Object(c.a)(this,(t=Object(s.a)(e)).call.apply(t,[this].concat(a)))).remoteController=new se({webSocketClient:Tt,log:console,vehicle:ht.vehicle,robot:xt}),n}return Object(u.a)(e,t),Object(i.a)(e,[{key:"render",value:function(){var t=this;return r.createElement(Xt,{grid:!0},r.createElement(le,null,r.createElement(ne,null,r.createElement(ae,{x:!0,name:"speed",onEvent:function(e,n,r){return t.onJoystickEvent(e,n,r)}})),r.createElement(ne,null,r.createElement(ae,{y:!0,name:"omega",onEvent:function(e,n,r){return t.onJoystickEvent(e,n,r)}}))))}},{key:"onJoystickEvent",value:function(t,e,n){if(-1!==["move","end"].indexOf(e.type)){var r="move"===e.type,a=r?Math.sin(n.angle.radian)*n.distance:0,o=r?Math.cos(n.angle.radian)*n.distance:0;switch(t){case"speed":this.remoteController.setSpeed(-1*o/100);break;case"omega":this.remoteController.setOmega(a/100);break;default:throw new Error('Got unexpected joystick "'.concat(t,'" info'))}}}}]),e}(r.Component),he=function(){return r.createElement(Xt,{text:!0},r.createElement("button",{onClick:function(){return window.location.href="http://kallaspriit"}},"Open http://kallaspriit"))};var de=function(){return r.createElement(b.c,{to:[vt]},function(t){var e=function(t){switch(t){case bt.UNKNOWN:return Kt.BAD;case bt.FULL:return Kt.GOOD;case bt.LOW:return Kt.WARN;case bt.CRITICAL:return Kt.BAD;default:return function(t,e){throw new Error("".concat(e," (").concat(t,")"))}(t,"got unexpected battery state")}}(t.batteryState),n=t.state.batteryVoltage?"".concat(t.state.batteryVoltage.toFixed(1),"V"):"Unknown";return r.createElement(ne,{status:e,onClick:function(){return xt.requestVoltage()}},r.createElement(U,null),r.createElement(M,{primary:!0},"Battery"),r.createElement(M,null,n))})};function me(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:" ",r="string"===typeof t?t:t.toString();if(r.length>=e)return r;var a=e-r.length;return"".concat(new Array(a+1).join(n)).concat(r)}var pe,be=n(41),ge=function(t){function e(){var t,n;Object(o.a)(this,e);for(var a=arguments.length,i=new Array(a),u=0;u<a;u++)i[u]=arguments[u];return(n=Object(c.a)(this,(t=Object(s.a)(e)).call.apply(t,[this].concat(i)))).ref=r.createRef(),n}return Object(u.a)(e,t),Object(i.a)(e,[{key:"componentDidUpdate",value:function(){if(!1!==this.props.scrollToBottom){var t=this.ref.current;if(t)t.scrollHeight-t.clientHeight<=t.scrollTop+50&&(t.scrollTop=t.scrollHeight-t.clientHeight);else console.warn("auto-scroll dom node not found")}}},{key:"render",value:function(){var t=this.props,e=(t.scrollToBottom,Object(be.a)(t,["scrollToBottom"]));return r.createElement("div",Object.assign({},e,{ref:this.ref}),this.props.children)}}]),e}(r.Component);function ve(){var t=Object(l.a)(["\n  background-color: ",";\n"]);return ve=function(){return t},t}function Oe(){var t=Object(l.a)(["\n  box-sizing: content-box;\n  position: absolute;\n  bottom: ",";\n  right: ",";\n  width: 32px;\n  height: 32px;\n  padding: 10px;\n  background-color: ",";\n"]);return Oe=function(){return t},t}function Ee(){var t=Object(l.a)(["\n  display: inline-block;\n  padding: 0 4px;\n  margin-left: 8px;\n  border-radius: 8px;\n  background-color: ",";\n  color: ",";\n"]);return Ee=function(){return t},t}function ye(){var t=Object(l.a)(["\n  padding-left: 6px;\n  border-left: 2px solid ",";\n  margin-left: 6px;\n"]);return ye=function(){return t},t}function Se(){var t=Object(l.a)(["\n  color: ",";\n"]);return Se=function(){return t},t}function je(){var t=Object(l.a)([""]);return je=function(){return t},t}function we(){var t=Object(l.a)(["\n  flex: 1;\n  overflow: scroll;\n  padding: 8px;\n"]);return we=function(){return t},t}function ke(){var t=Object(l.a)(['\n  grid-column: 1 / 4;\n  font-family: Consolas, "Courier New", Courier, monospace;\n  display: flex;\n  overflow: hidden;\n']);return ke=function(){return t},t}var Ce=j(ne)(ke()),Ne=j(ge)(we()),Te=j.div(je()),xe=j.span(Se(),function(t){return t.theme.text.secondary}),Ie=(pe={},Object(Z.a)(pe,tt.INFO,"#666"),Object(Z.a)(pe,tt.RX,"#090"),Object(Z.a)(pe,tt.TX,"#FF8000"),Object(Z.a)(pe,tt.ERROR,"#900"),pe),De=j.span(ye(),function(t){return Ie[t.type]}),Re=j.span(Ee(),function(t){return t.theme.text.primary},function(t){return t.theme.bg.tertiary}),Ae=j.div(Oe(),function(t){return t.theme.size.gridGap},function(t){return t.theme.size.gridGap},function(t){return t.theme.bg.tertiary}),Le=j(function(t){return r.createElement(C,Object.assign({},t,{url:"icons/clear.svg",width:32,height:32}))})(ve(),function(t){return t.theme.text.secondary}),Ue=function(){return r.createElement(b.c,{to:[it]},function(t){return r.createElement(Ce,null,r.createElement(Ne,null,t.state.entries.map(function(t){return r.createElement(Te,{key:t.id},r.createElement(xe,null,(e=t.time,"".concat(me(e.getHours(),2,"0"),":")+"".concat(me(e.getMinutes(),2,"0"),":")+"".concat(me(e.getSeconds(),2,"0"),".")+"".concat(me(e.getMilliseconds(),3,"0")))),r.createElement(De,{type:t.type},t.message),t.count>1?r.createElement(Re,null,t.count):null);var e})),r.createElement(Ae,{onClick:function(){return t.clear()}},r.createElement(Le,null)))})},Be=n(25),Me=n.n(Be),We=function(){return r.createElement(b.c,{to:[vt]},function(t){var e=t.getConnectedSerial(),n=void 0!==e?Kt.GOOD:Kt.BAD,a=e&&e.type===mt.BLUETOOTH?R:A,o=e?e.type:"Serial",i=Me()(e?e.state:"Disconnected");return r.createElement(ne,{status:n},r.createElement(a,null),r.createElement(M,{primary:!0},o),r.createElement(M,null,i))})},Fe=function(){return r.createElement(b.c,{to:[vt]},function(t){var e=t.state.webSocketState===ot.CONNECTED?Kt.GOOD:Kt.BAD,n=t.state.webSocketState!==ot.CONNECTED||void 0===t.state.remoteIp?Me()(t.state.webSocketState):t.state.remoteIp;return r.createElement(ne,{status:e,onClick:function(){return xt.ping(void 0===t.getConnectedSerial())}},r.createElement(L,null),r.createElement(M,{primary:!0},"Web Socket"),r.createElement(M,null,n))})};function Ge(){var t=Object(l.a)(["\n  grid-template-columns: 1fr 1fr 1fr;\n  grid-template-rows: 100px;\n"]);return Ge=function(){return t},t}var He=j(te)(Ge()),ze=function(){return r.createElement(Xt,{grid:!0},r.createElement(He,null,r.createElement(We,null),r.createElement(Fe,null),r.createElement(de,null),r.createElement(Ue,null)))};function Pe(){var t=Object(l.a)(["\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  animation: "," 1000ms;\n"]);return Pe=function(){return t},t}var Ve=j.div(Pe(),function(t){return t.theme.animation.fadeIn}),Ke=function(t){function e(){return Object(o.a)(this,e),Object(c.a)(this,Object(s.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(i.a)(e,[{key:"render",value:function(){return r.createElement(p.a,{theme:S},r.createElement(b.b,null,r.createElement(w,null),r.createElement(zt,null),r.createElement(f.a,null,r.createElement(Ve,null,r.createElement(h.a,null,r.createElement(d.a,{path:"/status",component:ze}),r.createElement(d.a,{path:"/map",component:Jt}),r.createElement(d.a,{path:"/remote",component:fe}),r.createElement(d.a,{path:"/bot",component:qt}),r.createElement(d.a,{path:"/settings",component:he}),r.createElement(d.a,{exact:!0,path:"/"},r.createElement(m.a,{to:"/status"}))),r.createElement(Y,null)))))}}]),e}(r.Component);a.render(r.createElement(Ke,null),document.getElementById("root"))}},[[43,2,1]]]);
//# sourceMappingURL=main.1a3f2828.chunk.js.map