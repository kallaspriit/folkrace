(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{10:function(t,e,n){"use strict";n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return h})),n.d(e,"d",(function(){return d}));var s=n(61),i=n.n(s),a=n(5),o=n(16),r=n(6);let c,l,h;!function(t){t.USB="usb",t.BLUETOOTH="bluetooth"}(c||(c={})),function(t){t.CONNECTING="CONNECTING",t.CONNECTED="CONNECTED",t.DISCONNECTED="DISCONNECTED",t.NOT_SUPPORTED="NOT_SUPPORTED",t.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",t.DISABLED="DISABLED"}(l||(l={})),function(t){t.UNKNOWN="UNKNOWN",t.FULL="FULL",t.LOW="LOW",t.CRITICAL="CRITICAL"}(h||(h={}));class d extends a.a{constructor(...t){super(...t),this.state={serials:{BLUETOOTH:{type:c.BLUETOOTH,state:l.DISCONNECTED,deviceName:void 0},USB:{type:c.USB,state:l.DISCONNECTED,deviceName:void 0}},transportState:r.a.DISCONNECTED}}setSerialState(t,e,n){const s=Object.keys(c).find(e=>c[e]===t);return this.setState(i()(this.state,{serials:{[s]:{$merge:{state:e,deviceName:n}}}}))}setTransportState(t){return this.setState({transportState:t})}setBatteryVoltage(t){return this.setState({batteryVoltage:t})}setRemoteIp(t){return this.setState({remoteIp:t})}setOffline(){return this.setState({remoteIp:void 0})}setLoopStatistics(t,e){return this.setState({lastBeaconTime:new Date,loopFrequency:t,loopTimeUs:e})}setResetReceived(){return this.setState({lastResetTime:new Date})}getConnectedSerial(){return Object.keys(this.state.serials).map(t=>this.state.serials[t]).find(t=>t.state===l.CONNECTED)}get batteryState(){const t=this.state.batteryVoltage;return void 0===t?h.UNKNOWN:t<=o.a.rules.battery.critical?h.CRITICAL:t<=o.a.rules.battery.low?h.LOW:h.FULL}}},104:function(t,e,n){"use strict";n.r(e);var s=n(0),i=n.n(s),a=n(59),o=n.n(a),r=(n(76),n(4)),c=n(40),l=n(7),h=n(3),d=n(5),u=n(43),p=n(44),g=n(1);class m extends d.a{constructor(...t){super(...t),this.state={roll:0,pitch:0,yaw:0,lastUpdated:new Date}}setAttitude(t){return this.setState(Object(g.a)(Object(g.a)({},t),{},{lastUpdated:new Date}))}}let f,v,S;!function(t){t.START="START",t.LEFT="LEFT",t.RIGHT="RIGHT"}(f||(f={})),function(t){t.UNKNOWN="UNKNOWN",t.PRESSED="PRESSED",t.RELEASED="RELEASED"}(v||(v={}));class b extends d.a{constructor(...t){super(...t),this.state={[f.START]:v.UNKNOWN,[f.LEFT]:v.UNKNOWN,[f.RIGHT]:v.UNKNOWN}}setButtonState(t,e){return this.setState({[t]:e})}}class y extends d.a{constructor(...t){super(...t),this.state={isStarted:!1,isValid:!1,targetRpm:0,currentRpm:0,motorPwm:0}}update(t){return this.setState(Object(g.a)({},t))}}!function(t){t.INFO="INFO",t.ERROR="ERROR",t.RX="RX",t.TX="TX"}(S||(S={}));class x extends d.a{constructor(...t){super(...t),this.state={entries:[]},this.lastId=0}addEntry(t,e=!0){this.setState(n=>{const s=this.state.entries.length>0?this.state.entries[this.state.entries.length-1]:null,i=this.resolveMessageType(t);if(null!==s&&e&&t===s.message){return{entries:[...n.entries.slice(0,this.state.entries.length-1),{id:(this.lastId++).toString(),time:new Date,message:t,type:i,count:s.count+1}]}}const a=[...n.entries,{id:(this.lastId++).toString(),time:new Date,message:t,type:i,count:1}];for(;a.length>200;)a.shift();return{entries:a}}).catch(t=>console.error(t))}clear(){this.setState({entries:[]}).catch(t=>console.error(t))}resolveMessageType(t){switch(t.substr(0,1)){case"<":return S.RX;case">":return S.TX;case"@":return S.ERROR;case"#":default:return S.INFO}}}class E extends d.a{constructor(...t){super(...t),this.state={measurements:[]}}add(t){const e=[...this.state.measurements,t];return e.length>360&&e.shift(),this.setState({measurements:e})}}class w extends d.a{constructor(...t){super(...t),this.state={left:0,right:0}}update(t,e){return this.setState({left:t,right:e})}}class O extends d.a{constructor(...t){super(...t),this.state={targetSpeed:{left:0,right:0},current:{left:0,right:0}}}setTargetSpeed(t,e){return this.setState({targetSpeed:{left:t,right:e}})}setCurrent(t,e){return this.setState({current:{left:t,right:e}})}}var T=n(10);var C=n(9);var N=n(11),k=n.n(N),M=n(18);function D(){return(D=Object(M.a)(k.a.mark((function t(e,{status:n}){var s,i,a,o;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=e[0],i=e[1],a="string"===typeof e[2]?e[2]:void 0,t.next=5,n.setSerialState(s,i,a);case 5:void 0!==(o=n.getConnectedSerial())&&s===o.type?C.a.requestState():n.setBatteryVoltage(void 0);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}const j={serial:function(t,e){return D.apply(this,arguments)},ip:function(t,{status:e}){const n=t[0];"null"===n?e.setOffline():e.setRemoteIp(n)},usb:function(t,e){},voltage:function(t,{status:e}){const n=parseFloat(t[0]);e.setBatteryVoltage(n)},button:function(t,{button:e}){const n=t[0],s=0===parseInt(t[1],10)?v.PRESSED:v.RELEASED;e.setButtonState(n.toUpperCase(),s)},reset:function(t,{status:e}){e.setResetReceived()},current:function(t,{robot:e}){const n=parseInt(t[0],10),s=parseInt(t[1],10);e.setCurrent(n,s)},lidar:function(t,{lidar:e}){const n=1===parseInt(t[0],10),s=1===parseInt(t[1],10),i=parseFloat(t[2]),a=parseFloat(t[3]),o=parseFloat(t[4]);e.update({isStarted:n,isValid:s,targetRpm:i,currentRpm:a,motorPwm:o})},pong:function(t,{log:e}){if(!C.a.pingSentTime)return;const n=Date.now()-C.a.pingSentTime;C.a.pingSentTime=void 0,e.addEntry("# ping: ".concat(n," ms"))},e:function(t,{odometry:e}){const n=parseInt(t[0],10),s=parseInt(t[1],10);e.update(n,s)},b:function(t,{status:e}){const n=parseInt(t[0],10),s=parseInt(t[1],10),i=s/n*1e3,a=n/s*1e3;e.setLoopStatistics(i,a)},l:function(t,{measurements:e}){for(let n=0;n<4;n++)e.add({angle:parseInt(t[0+3*n],10),distance:parseInt(t[1+3*n],10),quality:parseInt(t[2+3*n],10),timestamp:Date.now()})},s:function(t,{robot:e}){const n=parseInt(t[0],10),s=parseInt(t[1],10);e.setTargetSpeed(n,s)},a:function(t,{ahrs:e}){e.setAttitude({roll:parseFloat(t[0]),pitch:parseFloat(t[1]),yaw:parseFloat(t[2])})}};const z={};const R=[];var A=n(20);class I extends i.a.Component{constructor(...t){super(...t),this.isInitialized=!1}render(){return i.a.createElement(d.c,{to:[x,T.d,w,y,b,O,E,m]},(t,e,n,s,i,a,o,r)=>{if(this.isInitialized)return null;const c={log:t,status:e,odometry:n,lidar:s,button:i,robot:a,measurements:o,ahrs:r};var l,h;return l=c,Object.keys(l).forEach(t=>{const e=t;z[e]=l[e]}),h=e=>t.addEntry(e),R.push(h),e.setTransportState(A.a.getState()),A.a.addListener({onStateChanged:(n,s,i)=>{t.addEntry("# ".concat(n.getName()," state changed to ").concat(s)),e.setTransportState(s)},onError:(e,n)=>{t.addEntry("# transport error occurred".concat(n?" (".concat(n.message,")"):""))},onMessageSent:(e,n,s)=>{const i=n.split(":"),a=Object(p.a)(i,1)[0];1===a.length||["ping","!ping"].includes(a)||t.addEntry("> ".concat(n).concat(s?"":" (sending failed)"))},onMessageReceived:(t,e)=>{this.handleTransportMessage(e,c)}}),A.a.connect(),this.isInitialized=!0,null})}handleTransportMessage(t,e){if(0===t.length)return;const n=t.split(":"),s=Object(u.a)(n),i=s[0],a=s.slice(1);i.length>1&&-1===["pong","lidar"].indexOf(i)&&e.log.addEntry("< ".concat(t)),function(t,e,n){const s=j[t];void 0!==s?s(e,n):console.warn('missing web-socket command handler for "'.concat(t,'" (').concat(e.join(", "),")"))}(i,a,e)}}var L=n(31);function P(){const t=Object(r.a)(["\n  display: block;\n  width: ","px;\n  height: ","px;\n  mask-image: url(",");\n  mask-size: ","px ","px;\n  mask-repeat: no-repeat;\n  mask-position: center center;\n  background-color: ",";\n"]);return P=function(){return t},t}const F=h.d.i(P(),t=>t.width,t=>t.height,t=>t.url,t=>t.height,t=>t.width,t=>t.theme.text.primary),G=t=>i.a.createElement(F,Object.assign({},t,{url:"icons/status.svg",width:37,height:32})),B=t=>i.a.createElement(F,Object.assign({},t,{url:"icons/map.svg",width:32,height:32})),U=t=>i.a.createElement(F,Object.assign({},t,{url:"icons/bot.svg",width:27,height:32})),W=t=>i.a.createElement(F,Object.assign({},t,{url:"icons/remote.svg",width:44,height:32})),H=t=>i.a.createElement(F,Object.assign({},t,{url:"icons/settings.svg",width:32,height:32})),V=t=>i.a.createElement(F,Object.assign({},t,{url:"icons/bluetooth.svg",width:32,height:32})),q=t=>i.a.createElement(F,Object.assign({},t,{url:"icons/serial.svg",width:32,height:32})),K=t=>i.a.createElement(F,Object.assign({},t,{url:"icons/websocket.svg",width:32,height:32})),X=t=>i.a.createElement(F,Object.assign({},t,{url:"icons/native.svg",width:32,height:32})),_=t=>i.a.createElement(F,Object.assign({},t,{url:"icons/battery.svg",width:32,height:32})),J=t=>i.a.createElement(F,Object.assign({},t,{url:"icons/lidar.svg",width:32,height:32}));function Y(){const t=Object(r.a)(["\n  text-align: center;\n  font-variant: ",";\n  line-height: 1.2em;\n"]);return Y=function(){return t},t}const $=h.d.div(Y(),t=>t.primary?"all-small-caps":"normal");function Q(){const t=Object(r.a)(["\n  padding-top: 4px;\n"]);return Q=function(){return t},t}function Z(){const t=Object(r.a)(["\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  height: 100%;\n  text-decoration: none;\n  color: ",";\n  background-color: rgba(0, 0, 0, 0);\n  transition: background-color 300ms;\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n\n  &.active-main-menu-item {\n    background-color: ",";\n    color: ",";\n  }\n"]);return Z=function(){return t},t}function tt(){const t=Object(r.a)(["\n  height: 100%;\n  text-align: center;\n  font-variant: small-caps;\n  text-transform: uppercase;\n  font-size: 0.8em;\n  flex: 1;\n"]);return tt=function(){return t},t}function et(){const t=Object(r.a)(["\n  display: flex;\n  flex-direction: row;\n  height: ",";\n  flex: 1;\n  max-width: 600px;\n"]);return et=function(){return t},t}function nt(){const t=Object(r.a)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  background-color: #000;\n"]);return nt=function(){return t},t}const st=h.d.div(nt()),it=h.d.ul(et(),t=>t.theme.size.menuHeight),at=h.d.li(tt()),ot=Object(h.d)(c.b)(Z(),t=>Object(L.a)(t.theme.size.darkerLighterPercentage,t.theme.text.primary),t=>t.theme.bg.secondary,t=>t.theme.text.primary),rt=Object(h.d)($)(Q()),ct=()=>i.a.createElement(st,null,i.a.createElement(it,null,i.a.createElement(at,null,i.a.createElement(ot,{to:"/status",activeClassName:"active-main-menu-item"},i.a.createElement(G,null),i.a.createElement(rt,null,"Status"))),i.a.createElement(at,null,i.a.createElement(ot,{to:"/map",activeClassName:"active-main-menu-item"},i.a.createElement(B,null),i.a.createElement(rt,null,"Map"))),i.a.createElement(at,null,i.a.createElement(ot,{to:"/simulation",activeClassName:"active-main-menu-item"},i.a.createElement(U,null),i.a.createElement(rt,null,"Simulation"))),i.a.createElement(at,null,i.a.createElement(ot,{to:"/remote",activeClassName:"active-main-menu-item"},i.a.createElement(W,null),i.a.createElement(rt,null,"Remote"))),i.a.createElement(at,null,i.a.createElement(ot,{to:"/settings",activeClassName:"active-main-menu-item"},i.a.createElement(H,null),i.a.createElement(rt,null,"Settings")))));function lt(){const t=Object(r.a)(['\n  // main font\n  @font-face {\n    font-family: "heebo-regular";\n    src: url("fonts/Heebo-Regular.ttf");\n  }\n\n  @font-face {\n    font-family: "roboto-mono-light";\n    src: url("fonts/RobotoMono-Light.ttf");\n  }\n\n  // default to using border box sizing\n  html {\n    box-sizing: border-box;\n  }\n  *,\n  *:before,\n  *:after {\n    box-sizing: inherit;\n  }\n\n  // set body styles\n  body,\n  html {\n    height: 100%;\n    padding: 0;\n    margin: 0;\n    font-family: "heebo-regular";\n    color: ',";\n    background-color: ",";\n  }\n"]);return lt=function(){return t},t}function ht(){const t=Object(r.a)(["\n      0% {\n        background: ",";\n      }\n      50% {\n        background: ",";\n      }\n      100% {\n        background: ",";\n      }\n    "]);return ht=function(){return t},t}function dt(){const t=Object(r.a)(["\n      from {\n        opacity: 0;\n      }\n      to {\n        opacity: 1;\n      }\n    "]);return dt=function(){return t},t}const ut={text:{primary:"#f0f0f0",secondary:"#969696"},bg:{primary:"#cc3333",secondary:"#282828",tertiary:Object(L.b)(.05,"#282828"),quaternary:"#087099",good:"#009900",warn:"#999900",bad:"#990000"},size:{darkerLighterPercentage:.25,gridGap:"2px",menuHeight:"64px"},animation:{fadeIn:Object(h.e)(dt()),pulse:t=>Object(h.e)(ht(),t,Object(L.b)(.25,t),t)}},pt=Object(h.b)(lt(),ut.text.primary,ut.bg.secondary);var gt=n(67);function mt(){const t=Object(r.a)(["\n  position: relative;\n  flex: 1;\n  border-radius: 8px 8px 0 0;\n  padding: ",";\n"]);return mt=function(){return t},t}const ft=h.d.div(mt(),t=>t.text?"16px":"0"),vt=()=>i.a.createElement(ft,null,i.a.createElement(gt.a,{radius:4,cellSize:.1,measurements:()=>z.measurements.state.measurements}));function St(){const t=Object(r.a)(["\n          animation: ","\n            3s ease;\n          animation-iteration-count: infinite;\n          animation-delay: 1s;\n        "]);return St=function(){return t},t}function bt(){const t=Object(r.a)(["\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          justify-content: center;\n          padding: 16px;\n          overflow: hidden;\n          background-color: ",";\n        "]);return bt=function(){return t},t}function yt(){const t=Object(r.a)(["\n          line-height: 1.25em;\n          text-align: center;\n          margin-top: 8px;\n        "]);return yt=function(){return t},t}function xt(){const t=Object(r.a)(["\n  position: relative;\n  background-color: ",";\n  font-variant: ",";\n\n  ","\n\n  ","\n\n  ","\n"]);return xt=function(){return t},t}function Et(){const t=Object(r.a)(["\n          grid-template-rows: ",";\n        "]);return Et=function(){return t},t}function wt(){const t=Object(r.a)(["\n          grid-template-columns: ",";\n        "]);return wt=function(){return t},t}function Ot(){const t=Object(r.a)(["\n  display: grid;\n  grid-gap: ",";\n  margin: ",";\n  height: calc(\n    100vh -\n      (\n        "," +\n          ("," * 2)\n      )\n  );\n\n  ","\n\n  ","\n"]);return Ot=function(){return t},t}let Tt;!function(t){t.GOOD="GOOD",t.WARN="WARN",t.BAD="BAD"}(Tt||(Tt={}));const Ct=h.d.div(Ot(),t=>t.theme.size.gridGap,t=>t.theme.size.gridGap,t=>t.theme.size.menuHeight,t=>t.theme.size.gridGap,t=>t.columns?Object(h.c)(wt(),t.columns):"",t=>t.rows?Object(h.c)(Et(),t.rows):""),Nt=t=>({[Tt.GOOD]:t.bg.good,[Tt.WARN]:t.bg.warn,[Tt.BAD]:t.bg.bad}),kt=h.d.div(xt(),t=>t.theme.bg.tertiary,t=>t.primary?"all-small-caps":"normal",t=>t.text?Object(h.c)(yt()):"",t=>t.status?Object(h.c)(bt(),Nt(t.theme)[t.status]):"",t=>t.status===Tt.BAD?Object(h.c)(St(),t.theme.animation.pulse(Nt(t.theme)[t.status])):"");var Mt=n(68);class Dt extends i.a.Component{constructor(...t){super(...t),this.ref=i.a.createRef()}componentDidMount(){const t=this.ref.current;if(!t)return void console.warn("grid item dom node not found");const e=Object(Mt.create)({zone:t,color:"#FFF",size:200,position:{left:"50%",top:"50%"},mode:"static",lockX:!0===this.props.x,lockY:!0===this.props.y}),n=this.props.onEvent;if("function"===typeof n){const t="start,move,end,dir,plain";e.on(t,(t,e)=>{n(this.props.name,t,e)}),e.on("removed",(e,n)=>{n.off(t)})}}render(){return i.a.createElement("div",{className:"joystick",ref:this.ref})}}var jt=n(16),zt=n(45);class Rt extends i.a.Component{constructor(...t){super(...t),this.remoteController=new zt.a({vehicle:jt.a.vehicle,robot:C.a})}render(){return i.a.createElement(ft,null,i.a.createElement(Ct,null,i.a.createElement(kt,null,i.a.createElement(Dt,{x:!0,name:"speed",onEvent:(t,e,n)=>this.onJoystickEvent(t,e,n)})),i.a.createElement(kt,null,i.a.createElement(Dt,{y:!0,name:"omega",onEvent:(t,e,n)=>this.onJoystickEvent(t,e,n)}))))}onJoystickEvent(t,e,n){if(-1===["move","end"].indexOf(e.type))return;const s="move"===e.type,i=s?Math.sin(n.angle.radian)*n.distance:0,a=s?Math.cos(n.angle.radian)*n.distance:0;switch(t){case"speed":this.remoteController.setSpeed(-1*a/100);break;case"omega":this.remoteController.setOmega(i/100);break;default:throw new Error('Got unexpected joystick "'.concat(t,'" info'))}}}const At=()=>i.a.createElement(ft,{text:!0},i.a.createElement("p",null,i.a.createElement("button",{onClick:()=>window.location.href="http://kallaspriit"},"Open http://kallaspriit")),i.a.createElement("p",null,i.a.createElement("button",{onClick:()=>window.location.href="http://lab"},"Open http://lab")));var It=n(69);const Lt=()=>i.a.createElement(ft,null,i.a.createElement(It.a,null));const Pt=()=>i.a.createElement(d.c,{to:[T.d]},t=>{const e=function(t){switch(t){case T.a.UNKNOWN:return Tt.BAD;case T.a.FULL:return Tt.GOOD;case T.a.LOW:return Tt.WARN;case T.a.CRITICAL:return Tt.BAD;default:return function(t,e){throw new Error("".concat(e," (").concat(t,")"))}(t,"got unexpected battery state")}}(t.batteryState),n=t.state.batteryVoltage?"".concat(t.state.batteryVoltage.toFixed(1),"V"):"Unknown";return i.a.createElement(kt,{status:e,onClick:()=>C.a.requestVoltage()},i.a.createElement(_,null),i.a.createElement($,{primary:!0},"Battery"),i.a.createElement($,null,n))});const Ft=()=>i.a.createElement(d.c,{to:[y]},t=>{const e=function(t){let e=Tt.BAD,n="Stopped";t.state.isValid?(e=Tt.GOOD,n="".concat(Math.round(t.state.currentRpm),"/").concat(t.state.targetRpm," RPM")):t.state.isStarted&&(e=Tt.WARN,n="Unstable");return{status:e,description:n}}(t),n=e.status,s=e.description;return i.a.createElement(kt,{status:n,onClick:()=>t.state.isStarted?C.a.stopLidar():C.a.startLidar()},i.a.createElement(J,null),i.a.createElement($,{primary:!0},"Lidar"),i.a.createElement($,null,s))});function Gt(t,e,n=" "){const s="string"===typeof t?t:t.toString();if(s.length>=e)return s;const i=e-s.length;return"".concat(new Array(i+1).join(n)).concat(s)}var Bt=n(70);class Ut extends i.a.Component{constructor(...t){super(...t),this.ref=i.a.createRef()}componentDidUpdate(){if(!1===this.props.scrollToBottom)return;const t=this.ref.current;if(!t)return void console.warn("auto-scroll dom node not found");t.scrollHeight-t.clientHeight<=t.scrollTop+50&&(t.scrollTop=t.scrollHeight-t.clientHeight)}render(){const t=this.props,e=(t.scrollToBottom,Object(Bt.a)(t,["scrollToBottom"]));return i.a.createElement("div",Object.assign({},e,{ref:this.ref}),this.props.children)}}function Wt(){const t=Object(r.a)(["\n  background-color: ",";\n"]);return Wt=function(){return t},t}function Ht(){const t=Object(r.a)(["\n  box-sizing: content-box;\n  position: absolute;\n  bottom: ",";\n  right: ",";\n  width: 32px;\n  height: 32px;\n  padding: 10px;\n  background-color: ",";\n"]);return Ht=function(){return t},t}function Vt(){const t=Object(r.a)(["\n  display: inline-block;\n  padding: 0 4px;\n  margin-left: 8px;\n  border-radius: 8px;\n  background-color: ",";\n  color: ",";\n"]);return Vt=function(){return t},t}function qt(){const t=Object(r.a)(["\n  padding-left: 6px;\n  border-left: 2px solid ",";\n  margin-left: 6px;\n"]);return qt=function(){return t},t}function Kt(){const t=Object(r.a)(["\n  color: ",";\n"]);return Kt=function(){return t},t}function Xt(){const t=Object(r.a)([""]);return Xt=function(){return t},t}function _t(){const t=Object(r.a)(["\n  flex: 1;\n  overflow: scroll;\n  padding: 8px;\n"]);return _t=function(){return t},t}function Jt(){const t=Object(r.a)(['\n  grid-column: 1 / 4;\n  font-family: Consolas, "Courier New", Courier, monospace;\n  display: flex;\n  overflow: hidden;\n']);return Jt=function(){return t},t}const Yt=Object(h.d)(kt)(Jt()),$t=Object(h.d)(Ut)(_t()),Qt=h.d.div(Xt()),Zt=h.d.span(Kt(),t=>t.theme.text.secondary),te={[S.INFO]:"#666",[S.RX]:"#090",[S.TX]:"#FF8000",[S.ERROR]:"#900"},ee=h.d.span(qt(),t=>te[t.type]),ne=h.d.span(Vt(),t=>t.theme.text.primary,t=>t.theme.bg.tertiary),se=h.d.div(Ht(),t=>t.theme.size.gridGap,t=>t.theme.size.gridGap,t=>t.theme.bg.tertiary),ie=Object(h.d)(t=>i.a.createElement(F,Object.assign({},t,{url:"icons/clear.svg",width:32,height:32})))(Wt(),t=>t.theme.text.secondary),ae=()=>i.a.createElement(d.c,{to:[x]},t=>i.a.createElement(Yt,null,i.a.createElement($t,null,t.state.entries.map(t=>{return i.a.createElement(Qt,{key:t.id},i.a.createElement(Zt,null,(e=t.time,"".concat(Gt(e.getHours(),2,"0"),":")+"".concat(Gt(e.getMinutes(),2,"0"),":")+"".concat(Gt(e.getSeconds(),2,"0"),".")+"".concat(Gt(e.getMilliseconds(),3,"0")))),i.a.createElement(ee,{type:t.type},t.message),t.count>1?i.a.createElement(ne,null,t.count):null);var e})),i.a.createElement(se,{onClick:()=>t.clear()},i.a.createElement(ie,null))));var oe=n(41),re=n(6);const ce=()=>i.a.createElement(d.c,{to:[T.d]},t=>{const e=t.state.transportState===re.a.CONNECTED?Tt.GOOD:Tt.BAD,n=t.state.transportState!==re.a.CONNECTED||void 0===t.state.remoteIp?Object(oe.a)(t.state.transportState):t.state.remoteIp;return i.a.createElement(kt,{status:e,onClick:()=>C.a.ping(void 0===t.getConnectedSerial())},"Native"===A.a.getName()?i.a.createElement(X,null):i.a.createElement(K,null),i.a.createElement($,{primary:!0},A.a.getName()),i.a.createElement($,null,n))}),le=()=>i.a.createElement(d.c,{to:[T.d]},t=>{const e=t.getConnectedSerial(),n=void 0!==e?Tt.GOOD:Tt.BAD,s=e&&e.type===T.c.BLUETOOTH?V:q,a=e?e.type:"Serial",o=Object(oe.a)(e?e.state:"Disconnected");return i.a.createElement(kt,{status:n},i.a.createElement(s,null),i.a.createElement($,{primary:!0},a),i.a.createElement($,null,o))}),he=()=>i.a.createElement(ft,null,i.a.createElement(Ct,{columns:"1fr 1fr 1fr",rows:"100px 100px"},i.a.createElement(le,null),i.a.createElement(ce,null),i.a.createElement(Pt,null),i.a.createElement(Ft,null),i.a.createElement(ae,null)));function de(){const t=Object(r.a)(["\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  animation: "," 1000ms;\n"]);return de=function(){return t},t}class ue extends i.a.Component{render(){return i.a.createElement(h.a,{theme:ut},i.a.createElement(d.b,null,i.a.createElement(pt,null),i.a.createElement(I,null),i.a.createElement(c.a,null,i.a.createElement(pe,null,i.a.createElement(l.d,null,i.a.createElement(l.b,{path:"/status",component:he}),i.a.createElement(l.b,{path:"/map",component:vt}),i.a.createElement(l.b,{path:"/remote",component:Rt}),i.a.createElement(l.b,{path:"/simulation",component:Lt}),i.a.createElement(l.b,{path:"/settings",component:At}),i.a.createElement(l.b,null,i.a.createElement(l.a,{to:"/status"}))),i.a.createElement(ct,null)))))}}const pe=h.d.div(de(),t=>t.theme.animation.fadeIn);o.a.render(i.a.createElement(ue,null),document.getElementById("root"))},16:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));const s={webSocket:{host:void 0!==localStorage.webSocketHost?localStorage.webSocketHost:"127.0.0.1",port:void 0!==localStorage.webSocketPort?parseInt(localStorage.webSocketPort,10):8e3,useSSL:!1,reconnectInterval:3e3},rules:{battery:{low:15,critical:13.5}},vehicle:{trackWidth:.12,maxSpeed:1,wheelDiameter:.039,encoderCountsPerRotation:20,gearboxRatio:25,speedUpdateInterval:50}}},19:function(t,e,n){"use strict";n.d(e,"c",(function(){return s.a})),n.d(e,"d",(function(){return l})),n.d(e,"b",(function(){return h})),n.d(e,"a",(function(){return d}));var s=n(6),i=n(11),a=n.n(i),o=n(18),r=n(1),c=n(8);class l{constructor(t){this.options=void 0,this.log=void 0,this.listeners=[],this.state=s.a.DISCONNECTED,this.wasConnected=!1,this.ws=void 0,this.options=Object(r.a)({useSSL:!1,log:c.dummyLogger,reconnectInterval:1e3},t),this.log=this.options.log}getName(){return"WebSocket"}isAvailable(){return void 0!==WebSocket}getState(){return this.state}addListener(t){this.listeners.push(t)}connect(){var t=this;return Object(o.a)(a.a.mark((function e(){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n="".concat(t.options.useSSL?"wss":"ws","://").concat(t.options.host,":").concat(t.options.port),t.log.info("connecting to web-socket server at ".concat(n)),t.setState(t.wasConnected?s.a.RECONNECTING:s.a.CONNECTING),t.ws=new WebSocket(n),t.ws.onopen=e=>{t.log.info("established web-socket connection"),t.wasConnected=!0,t.setState(s.a.CONNECTED)},t.ws.onclose=e=>{const n="code: ".concat(e.code,", reason: ").concat(e.reason,", was clean: ").concat(e.wasClean?"yes":"no");t.wasConnected?t.log.warn("connection to web-socket was lost (".concat(n,")")):t.log.warn("connecting to web-socket failed (".concat(n,")")),t.setState(s.a.DISCONNECTED),t.wasConnected&&setTimeout(()=>{t.connect()},t.options.reconnectInterval)},t.ws.onerror=e=>{t.log.warn("got web-socket error"),t.listeners.forEach(e=>e.onError(t))},t.ws.onmessage=e=>{const n=e.data;t.listeners.forEach(e=>e.onMessageReceived(t,n))};case 8:case"end":return e.stop()}}),e)})))()}send(t){return this.ws&&this.state===s.a.CONNECTED?(this.ws.send(t),this.listeners.forEach(e=>e.onMessageSent(this,t,!0)),!0):(this.log.warn('sending message "'.concat(t,'" requested but websocket state is ').concat(this.state)),this.listeners.forEach(e=>e.onMessageSent(this,t,!1)),!1)}setState(t){if(t===this.state)return;const e=this.state;this.state=t,this.listeners.forEach(n=>n.onStateChanged(this,t,e))}}class h{constructor(t={}){this.options=void 0,this.log=void 0,this.listeners=[],this.bridgeExists=void 0,this.state=s.a.DISCONNECTED,this.native=void 0,this.options=Object(r.a)({log:c.dummyLogger},t),this.log=this.options.log,this.bridgeExists=void 0!==window.native}getName(){return"Native"}isAvailable(){return this.bridgeExists}getState(){return this.state}addListener(t){this.listeners.push(t)}connect(){var t=this;return Object(o.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.setState(s.a.CONNECTING),void 0!==window.native){e.next=5;break}return t.log.info("no native bridge is available"),t.setState(s.a.DISCONNECTED),e.abrupt("return");case 5:t.log.info("native bridge is available"),t.native=window.native,window.app={receive:e=>t.onMessageReceived(e)},t.send("!handshake"),t.setState(s.a.CONNECTING);case 10:case"end":return e.stop()}}),e)})))()}send(t){if(!this.native)return this.log.warn('sending message "'.concat(t,'" requested but the native bridge is not available')),this.listeners.forEach(e=>e.onMessageSent(this,t,!1)),!1;try{return this.native.receive(t),this.listeners.forEach(e=>e.onMessageSent(this,t,!0)),!0}catch(e){this.listeners.forEach(t=>t.onError(this,e))}return!1}setState(t){if(t===this.state)return;const e=this.state;this.state=t,this.listeners.forEach(n=>n.onStateChanged(this,t,e))}onMessageReceived(t){this.log.info('received: "'.concat(t,'"')),this.listeners.forEach(e=>e.onMessageReceived(this,t)),"!handshake"===t&&this.setState(s.a.CONNECTED)}}class d{constructor(t={}){this.options=void 0,this.log=void 0,this.listeners=[],this.transports=[],this.options=Object(r.a)({log:c.dummyLogger},t),this.log=this.options.log}getName(){const t=this.getActiveTransport();return t?t.getName():"None"}isAvailable(){return void 0!==this.getAvailableTransport()}getState(){const t=this.getActiveTransport();return t?t.getState():s.a.DISCONNECTED}addListener(t){this.listeners.push(t)}connect(){var t=this;return Object(o.a)(a.a.mark((function e(){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.transports.map(t=>t.getState()!==s.a.DISCONNECTED?Promise.resolve():t.connect()),e.next=3,Promise.all(n);case 3:case"end":return e.stop()}}),e)})))()}send(t){const e=this.getConnectedTransport();return e?e.send(t):(this.log.warn('sending message "'.concat(t,'" requested but there is no connected transport available')),this.listeners.forEach(e=>e.onMessageSent(this,t,!1)),!1)}addTransport(t){t.addListener({onStateChanged:(t,e,n)=>{const s=this.getActiveTransport();t===s&&this.listeners.forEach(s=>s.onStateChanged(t,e,n))},onError:(t,e)=>{const n=this.getActiveTransport();t===n&&this.listeners.forEach(n=>n.onError(t,e))},onMessageSent:(t,e,n)=>{const s=this.getActiveTransport();t===s&&this.listeners.forEach(s=>s.onMessageSent(t,e,n))},onMessageReceived:(t,e)=>{const n=this.getActiveTransport();t===n&&this.listeners.forEach(n=>n.onMessageReceived(t,e))}}),this.transports.push(t)}getAvailableTransport(){return this.transports.find(t=>t.isAvailable())}getConnectedTransport(){return this.transports.find(t=>t.getState()===s.a.CONNECTED)}getActiveTransport(){const t=this.getConnectedTransport();return t||this.getAvailableTransport()}}},20:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var s=n(19);const i=new s.b({});var a=n(25);const o=new a.a({log:console}),r=new a.b({simulatedRobot:o,log:console});var c=n(1),l=n(16);const h=new s.d(Object(c.a)({},l.a.webSocket)),d=new s.a({});d.addTransport(i),d.addTransport(h),d.addTransport(r)},25:function(t,e,n){"use strict";n.d(e,"c",(function(){return y})),n.d(e,"a",(function(){return x.a})),n.d(e,"b",(function(){return C}));var s=n(17),i=n(1),a=n(16),o=n(39),r=n(9);class c{constructor(t={}){this.options=void 0,this.frameDurations=[],this.lastFrameTime=void 0,this.options=Object(i.a)({historySize:60,averageSize:60},t)}update(){const t=Date.now();if(!this.lastFrameTime)return void(this.lastFrameTime=t);const e=t-this.lastFrameTime;this.frameDurations.push(e),this.frameDurations.length>this.options.historySize&&this.frameDurations.shift(),this.lastFrameTime=t}getFps(){const t=this.frameDurations.slice(Math.max(this.frameDurations.length-this.options.averageSize,0),this.frameDurations.length);if(0===t.length)return 0;return 1e3/(t.reduce((t,e)=>t+e,0)/t.length)}getHistory(){return this.frameDurations}}var l=n(8);class h{constructor(t={}){this.gamepads=[],this.options=void 0,this.log=void 0,this.options=Object(i.a)({log:l.dummyLogger,autoPoll:!0,defaultDeadzone:0,onConnect:t=>{},onDisconnect:t=>{},onUpdate:t=>{}},t),this.log=this.options.log,"function"===typeof navigator.getGamepads?(window.addEventListener("gamepadconnected",t=>{const e=t.gamepad;this.log.info("gamepad #".concat(e.index,' "').concat(e.id,'" connected (').concat(e.buttons.length," buttons, ").concat(e.axes.length," axes)"));const n=new d({index:e.index,defaultDeadzone:this.options.defaultDeadzone,log:this.log});n.addUpdateListener(t=>this.options.onUpdate(t)),this.options.autoPoll&&n.startPolling(),this.gamepads.push(n),this.options.onConnect(n)}),window.addEventListener("gamepaddisconnected",t=>{const e=t.gamepad,n=this.getGamepadByIndex(e.index);n?(this.log.info("gamepad #".concat(e.index,' "').concat(e.id,'" disconnected')),this.gamepads=this.gamepads.filter(t=>t!==n),n.stopPolling(),this.options.onDisconnect(n)):this.log.warn("gamepad #".concat(e.index,' "').concat(e.id,'" disconnected but no managed gamepad with this index was found, this should not happen'))})):this.log.info("gamepads are not supported")}getGamepadByIndex(t){return this.gamepads.find(e=>e.index===t)}getFirstAvailableGamepad(){return this.gamepads.length>0?this.gamepads[0]:void 0}}class d{constructor(t){this.index=void 0,this.axes=[],this.buttons=[],this.deadzone=[],this.defaultDeadzone=0,this.options=void 0,this.log=void 0,this.updateListeners=[],this.isPolling=!1,this.animationFrameRequest=void 0,this.options=Object(i.a)({defaultDeadzone:0,log:l.dummyLogger},t),this.index=this.options.index,this.defaultDeadzone=this.options.defaultDeadzone,this.log=this.options.log,this.poll()}setDeadzone(t,e){this.deadzone[t]=e}setDefaultDeadzone(t){this.defaultDeadzone=t}addUpdateListener(t){this.updateListeners.push(t)}removeUpdateListener(t){this.updateListeners=this.updateListeners.filter(e=>e!==t)}startPolling(){this.isPolling||this.log.info("starting polling of gamepad #".concat(this.index)),this.isPolling=!0,this.animationFrameRequest=requestAnimationFrame(()=>{this.animationFrameRequest=void 0,this.poll(),this.isPolling&&this.startPolling()})}stopPolling(){this.isPolling&&(this.isPolling=!1,this.log.info("stopping polling of gamepad #".concat(this.index)),void 0!==this.animationFrameRequest&&cancelAnimationFrame(this.animationFrameRequest))}poll(){const t=this.getCurrentState();if(!t)return this.log.warn("attempted to poll gamepad #".concat(this.index," but the gamepad could not be found")),void(this.isPolling&&this.stopPolling());this.axes=[...t.axes],this.buttons=[...t.buttons],this.applyDeadzone();var e,n=Object(s.a)(this.updateListeners);try{for(n.s();!(e=n.n()).done;){(0,e.value)(this)}}catch(i){n.e(i)}finally{n.f()}}getCurrentState(){const t=navigator.getGamepads()[this.index];if(void 0!==t&&null!==t)return t}applyDeadzone(){this.axes=this.axes.map((t,e)=>{const n=void 0!==this.deadzone[e]?this.deadzone[e]:this.defaultDeadzone;return Math.abs(t)<n?0:t})}}var u=n(33);class p{constructor(t,e){this.data=t,this.options=void 0,this.options=Object(i.a)({},e)}static generate({rows:t,columns:e,defaultValue:n},s){const i=[];for(let a=0;a<t;a++)i[a]=Array(e).fill(n);return new p(i,s)}setOccupancy({row:t,column:e,occupancy:n}){this.data[t][e]=n}setOccupancyAt({center:t,occupancy:e}){const n=this.getCellAtCoordinates(t),s=n.row,i=n.column;n.exists&&this.setOccupancy({row:s,column:i,occupancy:e})}getOccupancyAt(t){const e=this.getCellAtCoordinates(t),n=e.row,s=e.column;if(e.exists)return this.getOccupancy(n,s)}getOccupancy(t,e){if(void 0!==this.data[t]&&void 0!==this.data[t][e])return this.data[t][e]}getCellAtCoordinates(t){const e=this.getSize(),n=e.rows,s=e.columns,i=e.width,a=e.height,o=t.x+i/2,r=t.y+a/2,c=Math.floor(r/this.options.cellHeight),l=Math.floor(o/this.options.cellWidth);return{row:c,column:l,exists:c>=0&&c<n&&l>=0&&l<s}}getSize(){const t=this.data.length,e=this.data.length>0?this.data[0].length:0;return{rows:t,columns:e,width:t*this.options.cellWidth,height:e*this.options.cellHeight}}findShortestPath({from:t,to:e}){const n=new u.Grid(this.data);return new u.AStarFinder({diagonalMovement:u.DiagonalMovement.Never,heuristic:u.Heuristic.euclidean}).findPath(t[0],t[1],e[0],e[1],n)}}var g=n(45);class m{constructor(t){this.options=t,this.values=[]}report(t){const e=this.options.historyLength||200;this.values.push(t),this.values.length>e&&this.values.shift()}getLatest(){return 0===this.values.length?0:this.values[this.values.length-1]}}class f{constructor(){this.statistics=[]}create(t){const e=new m(t);this.statistics.push(e)}getByName(t){return this.statistics.find(e=>e.options.name===t)}report(t,e){const n=this.getByName(t);if(!n)throw new Error('Statistic called "'.concat(t,'" could not be found'));return n.report(e),n}}var v=n(27),S=n(42);let b;!function(t){t.FPS="FPS",t.PATH_FINDER="Path finder"}(b||(b={}));class y{constructor(t){this.options=t,this.occupancyGrid=void 0,this.fpsCounter=void 0,this.statistics=void 0,this.gamepadManager=void 0,this.remoteController=void 0,this.visualizer=void 0,this.ticker=void 0,this.gamepad=void 0,this.pulses=[],this.gridModificationMode=0,this.lastPathPlanningTime=0,this.path=[];const e=2*t.radius/t.cellSize;this.occupancyGrid=p.generate({rows:e,columns:e,defaultValue:0},{cellWidth:t.cellSize,cellHeight:t.cellSize}),this.fpsCounter=new c,this.statistics=new f,this.gamepadManager=new h({defaultDeadzone:.01,log:console,onConnect:t=>{console.log("GOT GAMEPAD",t,this.gamepadManager.gamepads),this.gamepad=this.gamepadManager.getFirstAvailableGamepad()},onDisconnect:t=>{console.log("LOST GAMEPAD",t,this.gamepadManager.gamepads),this.gamepad=this.gamepadManager.getFirstAvailableGamepad()},onUpdate:t=>{t.axes.forEach((e,n)=>{const s="Gamepad #".concat(t.index,".").concat(n);this.statistics.getByName(s)||this.statistics.create({name:s,min:-1,max:1,decimalPlaces:2}),this.statistics.report(s,e)})}}),this.remoteController=new g.a({vehicle:a.a.vehicle,robot:r.a,log:console}),this.visualizer=new S.a(this.options.container);const n={defaultStyle:{fillStyle:"#000",strokeStyle:"#000",font:"16px roboto-mono-light",textBaseline:"top"},getTransform:e=>{const n={x:e.width/2,y:e.height/2},s=-Math.PI/2,i=e.size/2/(t.radius+t.cellSize);return{horizontalScaling:-1,verticalSkewing:0,horizontalSkewing:0,verticalScaling:1,horizontalTranslation:n.x,verticalTranslation:n.y,rotation:s,scale:i}}};this.visualizer.createLayer(Object(i.a)(Object(i.a)({},n),{},{render:this.renderBackground.bind(this)})),this.visualizer.createLayer(Object(i.a)(Object(i.a)({},n),{},{render:this.renderMap.bind(this),onMouseDownEvent:this.onMouseDown.bind(this),onMouseUpEvent:this.onMouseUp.bind(this),onMouseMoveEvent:this.onMouseMove.bind(this)})),this.visualizer.createLayer({defaultStyle:{fillStyle:"#000",strokeStyle:"#000",font:"16px roboto-mono-light",textBaseline:"top"},render:this.renderForeground.bind(this)}),this.statistics.create({name:b.FPS,min:0,max:62}),this.statistics.create({name:b.PATH_FINDER,unit:"ms",min:0,max:100}),this.ticker=new v.a({tick:this.tick.bind(this)})}start(){this.visualizer.start(),this.ticker.start()}stop(){this.ticker.stop(),this.visualizer.stop()}tick(t){this.tickGamepad(t),this.tickPathFinder(t),this.fpsCounter.update()}tickGamepad(t){if(!this.gamepad)return;const e=-1*this.gamepad.axes[3],n=this.gamepad.axes[0];this.remoteController.setSpeed(e),this.remoteController.setOmega(n)}tickPathFinder(t){const e=Date.now();if(e-this.lastPathPlanningTime<this.options.pathPlanningIntervalMs)return;const n=Date.now();this.path=this.occupancyGrid.findShortestPath({from:[0,0],to:[this.occupancyGrid.data.length-1,this.occupancyGrid.data[0].length-1]});const s=Date.now()-n;this.statistics.report(b.PATH_FINDER,s),this.lastPathPlanningTime=e}renderBackground({layer:t,frame:e}){if(e>0)return;const n=this.options.cellSize,s=this.options.cellSize,i=2*this.options.radius/this.options.cellSize,a=this.options.radius/4;t.drawGrid({cellWidth:n,cellHeight:s,columns:2*Math.ceil(t.height/t.getScale()/n/2),rows:2*Math.ceil(t.width/t.getScale()/s/2),centered:!0},{strokeStyle:"#222"}),t.drawGrid({rows:i,columns:i,cellWidth:n,cellHeight:s,centered:!0},{strokeStyle:"#333"});for(let o=a;o<=this.options.radius;o+=a)t.drawCircle({radius:o},{strokeStyle:"#444"}),t.drawText({origin:{x:0,y:o},text:"".concat(o.toFixed(2),"m"),offset:{x:10,y:0}},{fillStyle:"#444",textBaseline:"middle"});t.drawCoordinateSystem({gridSize:this.options.cellSize})}renderMap({layer:t}){t.clear(),t.drawOccupancyGrid({grid:this.occupancyGrid.data,path:this.path,cellWidth:this.options.cellSize,cellHeight:this.options.cellSize,centered:!0}),this.drawPulses(t),Object(o.a)({center:{x:0,y:0},angle:0,layer:t})}renderForeground({layer:t}){t.clear();const e=this.fpsCounter.getFps();this.statistics.report(b.FPS,e),this.statistics.statistics.forEach((e,n)=>{t.drawGraph({name:"".concat(e.options.name,": ").concat(e.getLatest().toFixed(e.options.decimalPlaces||0)).concat(e.options.unit||""),origin:{x:10,y:30+90*n},min:e.options.min,max:e.options.max,values:e.values})});var n,i=Object(s.a)(this.gamepadManager.gamepads);try{for(i.s();!(n=i.n()).done;){const e=n.value,s=[e.buttons.reduce((t,e)=>(t.push(e.value),t),[])],i=200/e.buttons.length,a={x:10,y:10};t.drawGrid({origin:a,rows:1,columns:e.buttons.length,cellWidth:i,cellHeight:i},{strokeStyle:"#111"}),t.drawOccupancyGrid({grid:s,origin:a,cellWidth:i,cellHeight:i})}}catch(a){i.e(a)}finally{i.f()}}drawPulses(t){const e=Date.now();this.pulses=this.pulses.filter(({time:t})=>e-t<250),this.pulses.forEach(({x:n,y:s,time:i})=>t.drawPulse({center:{x:n,y:s},lifetime:250,age:e-i},{fillStyle:"#0F0"}))}onMouseDown({world:t}){const e=this.occupancyGrid.getOccupancyAt(t);void 0!==e&&(0===this.gridModificationMode&&(this.gridModificationMode=0===e?1:-1),this.occupancyGrid.setOccupancyAt({center:t,occupancy:1===e?0:1}),this.pulses.push(Object(i.a)(Object(i.a)({},t),{},{time:Date.now()})))}onMouseUp(t){this.gridModificationMode=0}onMouseMove({world:t,isMouseDown:e,event:n}){if(e&&0===n.button){if(0===this.gridModificationMode){const e=this.occupancyGrid.getOccupancyAt(t);this.gridModificationMode=0===e?1:-1}this.occupancyGrid.setOccupancyAt({center:t,occupancy:1===this.gridModificationMode?1:0})}}}var x=n(58),E=n(11),w=n.n(E),O=n(18),T=n(19);class C{constructor(t){this.options=void 0,this.log=void 0,this.listeners=[],this.state=T.c.DISCONNECTED,this.options=Object(i.a)({log:l.dummyLogger},t),this.log=this.options.log,this.options.simulatedRobot.addMessageListener(t=>this.onMessageReceived(t))}getName(){return"Simulated robot"}isAvailable(){return!0}getState(){return this.state}addListener(t){this.listeners.push(t)}connect(){var t=this;return Object(O.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.setState(T.c.CONNECTING),t.send("!handshake");case 2:case"end":return e.stop()}}),e)})))()}send(t){return this.options.simulatedRobot.receive(t),this.listeners.forEach(e=>e.onMessageSent(this,t,!0)),!0}setState(t){if(t===this.state)return;const e=this.state;this.state=t,this.listeners.forEach(n=>n.onStateChanged(this,t,e))}onMessageReceived(t){this.log.info('received: "'.concat(t,'"')),this.listeners.forEach(e=>e.onMessageReceived(this,t)),"!handshake"===t&&this.setState(T.c.CONNECTED)}}},27:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var s=n(1),i=n(8);class a{constructor(t){this.options=void 0,this.log=void 0,this.isRunning=!1,this.frameNumber=0,this.scheduledAnimationFrame=void 0,this.lastTickTime=void 0,this.options=Object(s.a)({autoStart:!1,log:i.dummyLogger},t),this.log=this.options.log,this.options.autoStart&&this.start()}start(){this.log.info("starting"),this.isRunning=!0,this.scheduleNextFrame()}stop(){this.log.info("stopping"),this.isRunning=!1,void 0!==this.scheduledAnimationFrame&&(cancelAnimationFrame(this.scheduledAnimationFrame),this.scheduledAnimationFrame=void 0)}tick(){if(!this.isRunning)return;const t=Date.now(),e=(this.lastTickTime?t-this.lastTickTime:16)/1e3;this.options.tick({dt:e,time:t,frame:this.frameNumber++}),this.lastTickTime=t}scheduleNextFrame(){this.scheduledAnimationFrame=window.requestAnimationFrame(t=>{this.scheduledAnimationFrame=void 0,this.isRunning&&(this.tick(),this.scheduleNextFrame())})}}},32:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));class s{constructor(t){this.options=t}static isSpeedDifferent(t,e,n=0){const s=Math.abs(t.left-e.left),i=Math.abs(t.right-e.right);return!(s<=n)&&!(i<=n)}static getLimitedSpeed(t,e){const n=Math.max(Math.abs(t.left),Math.abs(t.right)),s=Math.min(e/n,1);return{left:t.left*s,right:t.right*s}}getSpeedEncoderCount(t){const e=t/(this.options.wheelDiameter*Math.PI)*(this.options.encoderCountsPerRotation*this.options.gearboxRatio);return Math.floor(e)}getEncoderCountSpeed(t){const e=this.options.wheelDiameter*Math.PI;return t/(this.options.encoderCountsPerRotation*this.options.gearboxRatio)/e}motorToEncoderSpeed(t){return{left:this.getSpeedEncoderCount(t.left),right:this.getSpeedEncoderCount(t.right)}}encoderToMotorSpeed(t){return{left:this.getEncoderCountSpeed(t.left),right:this.getEncoderCountSpeed(t.right)}}motionToSpeed(t,e){const n={left:t+e,right:t-e};return s.getLimitedSpeed(n,this.options.maxSpeed)}speedToMotion(t){return{position:{x:0,y:0},angle:0}}}},39:function(t,e,n){"use strict";function s({center:t,angle:e,layer:n}){n.drawObject({center:t,angle:e,size:{x:.123,y:.195}})}n.d(e,"a",(function(){return s}))},42:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var s=n(44),i=n(17),a=n(1),o=n(63),r=n.n(o),c=n(21),l=n.n(c);function h(t,e,n,s,i,a=!0){const o=(t-e)*(i-s)/(n-e)+s;if(!a)return o;const r=Math.min(s,i),c=Math.max(s,i);return Math.min(Math.max(o,r),c)}var d=n(27);class u{constructor(t,e){this.canvas=t,this.options=void 0,this.ctx=void 0,this.width=void 0,this.height=void 0,this.size=void 0,this.transform=void 0,this.ticker=void 0,this.mouseDownCounter=0,this.options=Object(a.a)({defaultStyle:{fillStyle:"#000",strokeStyle:"#000",font:"16px monospace",textBaseline:"top"},getTransform:t=>({}),render:t=>{},onMouseDownEvent:t=>{},onMouseUpEvent:t=>{},onMouseMoveEvent:t=>{}},e);const n=this.canvas.getContext("2d");if(!n)throw new Error("Getting layer 2D context failed, this should not happen");this.ctx=n,this.width=this.canvas.offsetWidth,this.height=this.canvas.offsetHeight,this.size=Math.min(this.width,this.height)-2,this.canvas.setAttribute("width","".concat(this.width.toString(),"px")),this.canvas.setAttribute("height","".concat(this.height.toString(),"px")),this.canvas.style.removeProperty("width"),this.canvas.style.removeProperty("height");void 0===e.onMouseDownEvent&&void 0===e.onMouseUpEvent&&void 0===e.onMouseMoveEvent&&(this.canvas.style.pointerEvents="none"),this.transform=Object(a.a)({horizontalScaling:1,verticalSkewing:0,horizontalSkewing:0,verticalScaling:1,horizontalTranslation:0,verticalTranslation:0,rotation:0,scale:1},this.options.getTransform(this)),this.ctx.transform(this.transform.horizontalScaling,this.transform.verticalSkewing,this.transform.horizontalSkewing,this.transform.verticalScaling,this.transform.horizontalTranslation,this.transform.verticalTranslation),this.ctx.rotate(this.transform.rotation),this.applyStyle(this.options.defaultStyle),e.onMouseDownEvent&&(this.canvas.onmousedown=t=>this.handleMouseEvent("down",t)),e.onMouseUpEvent&&(this.canvas.onmouseup=t=>this.handleMouseEvent("up",t)),e.onMouseMoveEvent&&(this.canvas.onmousemove=t=>this.handleMouseEvent("move",t)),this.ticker=new d.a({tick:this.tick.bind(this)})}start(){this.ticker.start()}stop(){this.ticker.stop()}drawCircle(t,e={strokeStyle:"#000"}){const n=Object(a.a)({center:{x:0,y:0}},t),s=this.worldToScreen(n.center);this.ctx.save(),this.applyStyle(e),this.ctx.beginPath(),this.ctx.arc(s.x,s.y,this.scale(n.radius),0,2*Math.PI),e.fillStyle&&this.ctx.fill(),(e.strokeStyle||!e.strokeStyle&&!e.fillStyle)&&this.ctx.stroke(),this.ctx.restore()}drawPulse(t,e={strokeStyle:"#000"}){const n=Object(a.a)({center:{x:0,y:0},lifetime:300,age:0,size:this.size/50/this.getScale()},t);if(n.age>n.lifetime)return;const s=h(n.age,0,n.lifetime,1,0),i=r()(e.fillStyle||"#F00").alpha(s).toString();this.drawCircle({center:n.center,radius:h(n.age,0,n.lifetime,n.size/10,n.size)},{fillStyle:i})}drawMarker(t,e={}){const n=Object(a.a)({size:this.size/100/this.getScale()},t),s=this.isPolar(n.center)?n.center.angle:0,i=this.worldToScreen(n.center),o=this.scale(n.size);this.ctx.save(),this.applyStyle(e),this.ctx.translate(i.x,i.y),this.ctx.rotate(s),this.ctx.fillRect(-o/2,-o/2,o,o),this.ctx.restore()}drawBox(t,e={}){const n=Object(a.a)({padding:0,centered:!1},t),s=this.worldToScreen(n.origin),i=this.scale(n.width),o=this.scale(n.height),r=n.centered?{x:-i/2,y:-o/2}:{x:0,y:0};this.ctx.save(),this.applyStyle(e),e.fillStyle&&this.ctx.fillRect(s.x+r.x+n.padding,s.y+r.y+n.padding,i-2*n.padding,o-2*n.padding),(e.strokeStyle||!e.strokeStyle&&!e.fillStyle)&&this.ctx.strokeRect(s.x+r.x+n.padding,s.y+r.y+n.padding,i-2*n.padding,o-2*n.padding),this.ctx.restore()}drawLine(t,e={}){const n=Object(a.a)({},t),s=this.worldToScreen(n.from),i=this.worldToScreen(n.to);this.ctx.save(),this.applyStyle(e),this.ctx.beginPath(),this.ctx.moveTo(s.x,s.y),this.ctx.lineTo(i.x,i.y),this.ctx.stroke(),this.ctx.restore()}drawGrid(t,e={}){const n=Math.ceil(this.height/this.getScale()/t.cellHeight),s=Math.ceil(this.width/this.getScale()/t.cellWidth),i=Object(a.a)({origin:{x:0,y:0},centered:!1,rows:n%2===0?n:n+1,columns:s%2===0?s:s+1},t),o=i.cellHeight*i.rows,r=i.cellWidth*i.columns,c=this.toCartesian(i.origin),l=i.centered?{x:-r/2,y:-o/2}:{x:0,y:0};for(let a=0;a<=i.rows;a++){const t=a*i.cellHeight;this.drawLine({from:{x:c.x+l.x,y:c.y+l.y+t},to:{x:c.x+l.x+r,y:c.y+l.y+t}},e)}for(let a=0;a<=i.columns;a++){const t=a*i.cellWidth;this.drawLine({from:{x:c.x+l.x+t,y:c.y+l.y},to:{x:c.x+l.x+t,y:c.y+l.y+o}},e)}}drawOccupancyGrid(t,e={}){const n=Object(a.a)({origin:{x:0,y:0},centered:!1,path:[]},t);if(0===n.grid.length)return;const o=n.grid.length,r=n.grid[0].length,c=n.cellWidth*r,l=n.cellHeight*o,h=this.toCartesian(n.origin),d=n.centered?{x:-c/2,y:-l/2}:{x:0,y:0};for(let s=0;s<o;s++)for(let t=0;t<r;t++){if(!Array.isArray(n.grid[s]))throw new Error("Expected occupancy map row #".concat(s," to be an array, got ").concat(typeof n.grid[s]));const e=n.grid[s][t];if("number"!==typeof e)throw new Error("Expected occupancy map row cell ".concat(s,"x").concat(t," to be a number, got ").concat(typeof e));if(e<=0)continue;const i={x:t*n.cellWidth,y:s*n.cellHeight},a={x:h.x+d.x+i.x,y:h.y+d.y+i.y};this.drawBox({origin:a,width:n.cellWidth,height:n.cellHeight,padding:1},{fillStyle:"rgba(0, 0, 0, ".concat(e,")")})}var u,p=Object(i.a)(n.path);try{for(p.s();!(u=p.n()).done;){const t=Object(s.a)(u.value,2),e=t[0],i=t[1],a={x:e*n.cellWidth,y:i*n.cellHeight},o={x:h.x+d.x+a.x,y:h.y+d.x+a.y};this.drawBox({origin:o,width:n.cellWidth,height:n.cellHeight,padding:1},{fillStyle:"rgba(0, 255, 0, 0.2)"})}}catch(g){p.e(g)}finally{p.f()}}drawArrow(t,e={}){const n=Object(a.a)({tipSize:this.size/100/this.getScale(),name:""},t);this.drawLine(Object(a.a)({},n),e);const s=this.worldToScreen(n.from),i=this.worldToScreen(n.to),o=l.a.fromObject(i).subtract(l.a.fromObject(s)).angle();this.drawDirection(Object(a.a)(Object(a.a)({},n),{},{center:n.to,angle:o,size:n.tipSize}),e)}drawDirection(t,e={}){const n=Object(a.a)({size:this.size/100/this.getScale(),name:""},t),s=this.worldToScreen(n.center),i=this.scale(n.size);if(this.ctx.save(),this.applyStyle(e),this.ctx.translate(s.x,s.y),this.ctx.rotate(n.angle),this.ctx.beginPath(),this.ctx.moveTo(-i/2,i/2),this.ctx.lineTo(-i/2,-i/2),this.ctx.lineTo(0,0),this.ctx.lineTo(-i/2,i/2),this.ctx.fill(),this.ctx.restore(),n.name.length>0){const t=this.toCartesian(n.center);t.x+=2*n.size,this.drawText({origin:t,text:n.name},e)}}drawText(t,e={}){const n=Object(a.a)({offset:{x:0,y:0}},t),s=this.worldToScreen(n.origin);this.ctx.save(),this.applyStyle(e),this.ctx.translate(s.x,s.y),this.ctx.rotate(-this.transform.rotation),this.ctx.scale(this.transform.horizontalScaling,this.transform.verticalScaling),this.ctx.fillText(n.text,n.offset.x,n.offset.y),this.ctx.restore()}drawCoordinateSystem(t={}){const e=this.screenToWorld({x:this.width,y:this.height}),n=void 0!==t.gridSize?t.gridSize:this.size/50/this.getScale(),s=2*n,i=Object(a.a)({center:{x:-Math.ceil(e.y/2/n)*n+s,y:-Math.ceil(e.x/2/n)*n+s},gridSize:n,length:s},t),o=l.a.fromObject(this.toCartesian(i.center)),r=o.clone().add(new l.a(i.length,0)),c=o.clone().add(new l.a(0,i.length));this.drawArrow({from:i.center,to:r,name:"X"},{lineWidth:2,color:"#F00",textAlign:"center"}),this.drawArrow({from:i.center,to:c,name:"Y"},{lineWidth:2,color:"#0F0",textAlign:"center"})}drawGraph(t){const e=Object(a.a)({width:200,height:80},t),n=this.worldToScreen(e.origin),s=Math.max(e.values.length-e.width,0),i=e.values.slice(s,e.values.length),o=void 0!==t.min?t.min:Math.min(...i),r=void 0!==t.max?t.max:Math.max(...i),c=r-o;this.ctx.save(),this.ctx.translate(n.x,n.y),this.ctx.fillStyle="rgba(0, 0, 0, 0.1)",this.ctx.fillRect(0,0,e.width,e.height);let l=e.width;this.ctx.beginPath();let h=!1;for(let a=i.length;a>=0;a--){const t=i[a],n=Math.min(Math.max(t,o),r),s=Math.abs(n-t)>.1,d=e.height-Math.round((n-o)/c*e.height);0===a?this.ctx.moveTo(l,d):this.ctx.lineTo(l,d),l--,s&&(h=!0)}this.ctx.strokeStyle=h?"rgba(200, 0, 0, 0.75)":"rgba(0, 200, 0, 0.75)",this.ctx.stroke(),this.ctx.restore(),this.drawText({origin:t.origin,text:t.name,offset:{x:10,y:10}},{fillStyle:"#FFF"})}drawObject(t){const e=Object(a.a)(Object(a.a)({},t),{},{size:{x:this.size/50/this.getScale(),y:this.size/50/this.getScale()},draw:(t,{size:e})=>{const n=this.worldToScreen(e);t.fillStyle="#900",t.fillRect(-n.x/2,-n.y/2,n.x,n.y);const s=.5*Math.min(n.x,n.y);t.fillStyle="#FFF",t.beginPath(),t.moveTo(-s/2,-s/2),t.lineTo(0,s/2),t.lineTo(s/2,-s/2),t.lineTo(-s/2,-s/2),t.fill()}}),n=this.worldToScreen(e.center);this.ctx.save(),this.ctx.translate(n.x,n.y),this.ctx.rotate(e.angle),e.draw(this.ctx,Object(a.a)(Object(a.a)({},e),{},{layer:this})),this.ctx.restore()}polarToCartesian({angle:t,distance:e}){return{x:e*Math.cos(t),y:e*Math.sin(t)}}toCartesian(t){if(this.isPolar(t)){const e=Math.PI/2;return{x:t.distance*Math.cos(t.angle+e),y:t.distance*Math.sin(t.angle+e)}}return t}worldToScreen(t){const e=this.toCartesian(t),n=e.x,s=e.y;return{x:this.scale(n),y:this.scale(s)}}screenToWorld(t){const e=this.toCartesian(t),n=e.x,s=e.y,i=this.getScale();return{x:n/i,y:s/i}}canvasToScreen(t){const e=l.a.fromObject(this.getScreenOrigin()),n=l.a.fromObject(t).subtract(e).rotate(this.transform.rotation).multiply(new l.a(this.transform.horizontalScaling,this.transform.verticalScaling));return{x:n.x,y:n.y}}isPolar(t){return"number"===typeof t.angle&&"number"===typeof t.distance}getScale(){return this.transform.scale}scale(t){return t*this.getScale()}toRadians(t){return t*(Math.PI/180)}clear(){this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.width,this.height),this.ctx.restore()}applyStyle(t){t.color&&(this.ctx.strokeStyle=t.color,this.ctx.fillStyle=t.color),t.strokeStyle&&(this.ctx.strokeStyle=t.strokeStyle),t.fillStyle&&(this.ctx.fillStyle=t.fillStyle),t.lineWidth&&(this.ctx.lineWidth=t.lineWidth),t.font&&(this.ctx.font=t.font),t.textAlign&&(this.ctx.textAlign=t.textAlign),t.textBaseline&&(this.ctx.textBaseline=t.textBaseline)}getScreenOrigin(){return{x:this.width/2,y:this.height/2}}tick(t){this.options.render(Object(a.a)(Object(a.a)({},t),{},{layer:this}))}handleMouseEvent(t,e){const n=this.canvasToScreen(e),s={screen:n,world:this.screenToWorld(n),isMouseDown:this.mouseDownCounter>0,event:e};switch(t){case"down":this.mouseDownCounter++,this.options.onMouseDownEvent(Object(a.a)({type:t},s));break;case"up":this.mouseDownCounter--,this.options.onMouseUpEvent(Object(a.a)({type:t},s));break;case"move":this.options.onMouseMoveEvent(Object(a.a)({type:t},s))}}}class p{constructor(t){this.container=t,this.layers=[]}createLayer(t){const e=this.createCanvasElement();this.container.append(e);const n=new u(e,t);return this.layers.push(n),n}start(){var t,e=Object(i.a)(this.layers);try{for(e.s();!(t=e.n()).done;){t.value.start()}}catch(n){e.e(n)}finally{e.f()}}stop(){var t,e=Object(i.a)(this.layers);try{for(e.s();!(t=e.n()).done;){t.value.stop()}}catch(n){e.e(n)}finally{e.f()}}createCanvasElement(){const t=document.createElement("canvas");return t.style.position="absolute",t.style.width="100%",t.style.height="100%",t.style.left="0",t.style.right="0",t}}},45:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var s=n(1),i=n(62),a=n.n(i),o=n(8),r=n(32);class c{constructor(t){this.options=void 0,this.kinematics=void 0,this.robot=void 0,this.scheduleUpdateMotorSpeeds=void 0,this.speed=0,this.omega=0,this.lastSentSpeed=void 0,this.options=Object(s.a)({log:o.dummyLogger},t),this.robot=this.options.robot,this.kinematics=new r.a(this.options.vehicle),this.scheduleUpdateMotorSpeeds=a()(()=>this.updateMotorSpeeds(),this.options.vehicle.speedUpdateInterval)}setSpeed(t){this.speed=t,this.scheduleUpdateMotorSpeeds()}setOmega(t){this.omega=t,this.scheduleUpdateMotorSpeeds()}updateMotorSpeeds(){const t=this.kinematics.motionToSpeed(this.speed,this.omega),e=this.kinematics.motorToEncoderSpeed(t);this.lastSentSpeed&&!r.a.isSpeedDifferent(e,this.lastSentSpeed)||(this.robot.setSpeed(e.left,e.right),this.lastSentSpeed=e)}}},58:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return d}));var s=n(43),i=n(1),a=n(8),o=n(16),r=n(10),c=n(27),l=n(32);let h;!function(t){t.HANDSHAKE="!handshake",t.VOLTAGE="voltage",t.SPEED="s",t.RPM="rpm",t.CURRENT="current",t.PING="ping",t.STATE="state",t.PROXY="proxy",t.LIDAR_STATE="lidar",t.PONG="pong",t.BUTTON="button",t.ENCODER="e",t.RESET="reset",t.LIDAR_MEASUREMENT="l",t.SERIAL="serial"}(h||(h={}));class d{constructor(t){this.location={x:0,y:0},this.speed={left:0,right:0},this.angle=0,this.options=void 0,this.log=void 0,this.kinematics=void 0,this.ticker=void 0,this.messageListeners=[],this.buttonStates={left:1,right:1,start:1},this.current={left:0,right:0},this.encoderValues={left:0,right:0},this.targetSpeed={left:0,right:0},this.options=Object(i.a)({log:a.dummyLogger},t),this.log=this.options.log,this.kinematics=new l.a(o.a.vehicle),this.ticker=new c.a({tick:this.tick.bind(this)}),this.ticker.start()}addMessageListener(t){this.messageListeners.push(t),this.reportVoltage()}send(e){t(()=>{this.messageListeners.forEach(t=>t(e))})}receive(t){const e=t.split(":"),n=Object(s.a)(e),i=n[0],a=n.slice(1);switch(i){case h.HANDSHAKE:this.reportHandshake();break;case h.STATE:this.reportState();break;case h.VOLTAGE:this.reportVoltage();break;case h.SPEED:this.setSpeed({left:parseFloat(a[0]),right:parseFloat(a[1])});break;default:return void this.log.warn('missing handler for "'.concat(t,'"'))}this.log.info('handled command "'.concat(t,'"'))}setSpeed(t){this.targetSpeed=t}tick(t){this.tickLocation(t)}tickLocation({dt:t}){this.speed=this.targetSpeed,this.encoderValues={left:this.speed.left*t,right:this.speed.right*t}}reportHandshake(){this.send("!handshake"),this.send("serial:".concat(r.c.USB,":").concat(r.b.CONNECTED))}reportState(){this.reportButtonStates(),this.reportTargetSpeed(),this.reportLidarState(),this.reportVoltage(),this.reportCurrent(),this.reportEncoderValues()}reportVoltage(){this.send("voltage:15.9")}reportButtonState(t){this.send("button:".concat(t,":").concat(this.buttonStates[t]))}reportButtonStates(){this.reportButtonState("left"),this.reportButtonState("right"),this.reportButtonState("start")}reportTargetSpeed(){this.send("s:".concat(this.targetSpeed.left,":").concat(this.targetSpeed.right))}reportLidarState(){this.send("lidar:0:0:0:0:0")}reportCurrent(){this.send("current:".concat(this.current.left,":").concat(this.current.right))}reportEncoderValues(){this.send("e:".concat(this.encoderValues.left,":").concat(this.encoderValues.right))}}}).call(this,n(51).setImmediate)},6:function(t,e,n){"use strict";let s;n.d(e,"a",(function(){return s})),function(t){t.DISCONNECTED="DISCONNECTED",t.CONNECTING="CONNECTING",t.RECONNECTING="RECONNECTING",t.CONNECTED="CONNECTED"}(s||(s={}))},67:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return u}));var s=n(4),i=n(17),a=n(1),o=n(0),r=n.n(o),c=n(3),l=n(42),h=n(39);function d(){const t=Object(s.a)(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n"]);return d=function(){return t},t}class u extends r.a.Component{constructor(...t){super(...t),this.wrapRef=r.a.createRef(),this.visualizer=null}componentDidMount(){t(()=>this.setupMap())}componentWillUnmount(){null!==this.visualizer&&(this.visualizer.stop(),this.visualizer=null)}render(){return r.a.createElement(p,{ref:this.wrapRef})}setupMap(){const t=this.wrapRef.current;if(!t)throw new Error("Wrap element was not found, this should not happen");this.visualizer=new l.a(t);const e={getTransform:t=>{const e={x:t.width/2,y:t.height/2},n=-Math.PI/2,s=t.size/2/(this.props.radius+this.props.cellSize);return{horizontalScaling:-1,verticalSkewing:0,horizontalSkewing:0,verticalScaling:1,horizontalTranslation:e.x,verticalTranslation:e.y,rotation:n,scale:s}}};this.visualizer.createLayer(Object(a.a)(Object(a.a)({},e),{},{render:this.renderBackground.bind(this)})),this.visualizer.createLayer(Object(a.a)(Object(a.a)({},e),{},{render:this.renderMap.bind(this)})),this.visualizer.start()}renderBackground({layer:t,frame:e}){if(e>0)return;const n=2*this.props.radius/this.props.cellSize,s=this.props.radius/4;t.drawGrid({cellWidth:this.props.cellSize,cellHeight:this.props.cellSize,columns:2*Math.ceil(t.height/t.getScale()/this.props.cellSize/2),rows:2*Math.ceil(t.width/t.getScale()/this.props.cellSize/2),centered:!0},{strokeStyle:"#222"}),t.drawGrid({rows:n,columns:n,cellWidth:this.props.cellSize,cellHeight:this.props.cellSize,centered:!0},{strokeStyle:"#333"});for(let i=s;i<=this.props.radius;i+=s)t.drawCircle({radius:i},{strokeStyle:"#444"}),t.drawText({origin:{x:0,y:i},text:"".concat(i.toFixed(2),"m"),offset:{x:10,y:0}},{fillStyle:"#444",textBaseline:"middle"});t.drawCoordinateSystem()}renderMap({layer:t}){t.clear();const e=this.props.measurements();var n,s=Object(i.a)(e);try{for(s.s();!(n=s.n()).done;){const e=n.value;t.drawMarker({center:{angle:t.toRadians(e.angle),distance:e.distance/1e3}},{fillStyle:"rgba(255, 255, 255, ".concat(e.quality/100,")")})}}catch(a){s.e(a)}finally{s.f()}Object(h.a)({center:{x:0,y:0},angle:0,layer:t})}}const p=c.d.div(d())}).call(this,n(51).setImmediate)},69:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return l}));var s=n(4),i=n(0),a=n.n(i),o=n(3),r=n(25);function c(){const t=Object(s.a)(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n"]);return c=function(){return t},t}class l extends a.a.Component{constructor(...t){super(...t),this.containerRef=a.a.createRef(),this.simulator=null}componentDidMount(){t(()=>this.setup())}componentWillUnmount(){null!==this.simulator&&(this.simulator.stop(),this.simulator=null)}render(){return a.a.createElement(h,{ref:this.containerRef})}setup(){const t=this.containerRef.current;if(!t)throw new Error("Wrap element was not found, this should not happen");this.simulator=new r.c({container:t,radius:4,cellSize:.1,pathPlanningIntervalMs:100}),this.simulator.start()}}const h=o.d.div(c())}).call(this,n(51).setImmediate)},71:function(t,e,n){t.exports=n(104)},9:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var s=n(1);var i=n(20);const a=new class{constructor(t,e={}){this.transport=t,this.pingSentTime=void 0,this.config=void 0,this.config=Object(s.a)({targetLidarRpm:300},e)}requestVoltage(){this.send("voltage")}requestState(){this.send("state")}setSpeed(t,e){this.send("s",t,e)}ping(t=!1){this.pingSentTime=Date.now(),t?this.send("!ping"):this.send("ping")}startLidar(){this.send("rpm:".concat(this.config.targetLidarRpm))}stopLidar(){this.send("rpm:0")}send(t,...e){const n="".concat(t).concat(e.length>0?":":"").concat(e.join(":"));this.transport.send(n)}}(i.a)}},[[71,1,2]]]);
//# sourceMappingURL=main.5488e5f5.chunk.js.map